<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="MotrpacRatTraining6mo">
<title>Key metabolites • MotrpacRatTraining6mo</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Key metabolites">
<meta property="og:description" content="MotrpacRatTraining6mo">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Key metabolites</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/HEAD/vignettes/key_metabolites.Rmd" class="external-link"><code>vignettes/key_metabolites.Rmd</code></a></small>
      <div class="d-none name"><code>key_metabolites.Rmd</code></div>
    </div>

    
    
<style>
#TOC {
  top: 1%;
  opacity: 0.5;
}
#TOC:hover {
  opacity: 1;
}
</style>
<div class="section level2">
<h2 id="motivation">Motivation<a class="anchor" aria-label="anchor" href="#motivation"></a>
</h2>
<p>This report was motivated by this reviewer comment:</p>
<p><strong>Reviewer 1:</strong> Given the extensive collection of
metabolomics data (targeted and untargeted) for so many tissues and
temporal timepoints (Figure 1C) it will be interesting to explore the
changes of several key cellular metabolites in addition to the KEGG
pathways. For example, it will be interesting to see sex- and
time-specific changes in the plasma, muscles, heart of such metabolites
as glucose, pyruvate, lactate, acetate, perhaps key intermediates of
glycolysis and the TCA cycle. If the data is available, it will be also
interesting to characterize the changes in the energy and redox ratios,
i.e. ATP/ADP, NADH/NAD+ (or individual concentrations, such as ATP).
Given the central roles of these metabolites in cellular
physiology/health and multiple changes in the corresponding metabolic
pathways (Figure 7), it will be good to present and discuss the observed
metabolic changes.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo" class="external-link">MotrpacRatTraining6mo</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com" class="external-link">data.table</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span><span class="fu">knitr</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/knitr/man/opts_chunk.html" class="external-link">opts_chunk</a></span><span class="op">$</span><span class="fu">set</span><span class="op">(</span>echo <span class="op">=</span> <span class="cn">TRUE</span>, message <span class="op">=</span> <span class="cn">FALSE</span>, warning <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="metabolites-manually-selected-for-biological-relevance">Metabolites manually selected for biological relevance<a class="anchor" aria-label="anchor" href="#metabolites-manually-selected-for-biological-relevance"></a>
</h2>
<p>First, let’s look at metabolites selected for physiological relevance
in the plasma, liver, and skeletal muscle. Just for this section,
<strong>we will plot the metabolites whether or not they are
training-regulated</strong>. For each metabolite, the trajectory of the
normalized sample-level data is shown on the left, and the log
fold-changes from the timewise differential analysis are shown on the
right. Multiple traces are shown if multiple platforms measured the
metabolite.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">meta</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">METAB_FEATURE_ID_MAP</span><span class="op">)</span></span>
<span><span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AMP"</span>,<span class="st">"ADP"</span>,<span class="st">"ATP"</span>,<span class="st">"NAD+"</span>,<span class="st">"NADH"</span>,<span class="st">"Glucose"</span>,<span class="st">"Pyruvic acid"</span>,<span class="st">"Lactic acid"</span>,<span class="st">"Oxaloacetic acid"</span>,<span class="st">"Citric acid"</span>,<span class="st">"Succinic acid"</span>,<span class="st">"acetate"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># message(m)</span></span>
<span>  <span class="va">sub</span> <span class="op">=</span> <span class="va">meta</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"^%s$"</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\+"</span>,<span class="st">"\\\\+"</span>,<span class="va">m</span><span class="op">)</span><span class="op">)</span>, <span class="va">metabolite_name</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|</span> </span>
<span>                     <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"^%s$"</span>,<span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\+"</span>,<span class="st">"\\\\+"</span>,<span class="va">m</span><span class="op">)</span><span class="op">)</span>, <span class="va">metabolite_refmet</span>, ignore.case <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="co"># sub = meta[grepl(m, metabolite_name) | grepl(m, metabolite_refmet)]</span></span>
<span>  <span class="co"># print(sub[,metabolite_refmet])</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sub</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s not found"</span>, <span class="va">m</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">next</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">features</span>, <span class="va">m</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co">#&gt; Warning: acetate not found</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw">for</span><span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">features</span><span class="op">)</span><span class="op">{</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">TISSUE</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"SKM-GN"</span>,<span class="st">"SKM-VL"</span>,<span class="st">"PLASMA"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span></span>
<span>    <span class="co"># sample-level data</span></span>
<span>    <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_feature_normalized_data.html">plot_feature_normalized_data</a></span><span class="op">(</span>feature_ID<span class="op">=</span><span class="va">f</span>, </span>
<span>                                     assay<span class="op">=</span><span class="st">"METAB"</span>,</span>
<span>                                     tissue<span class="op">=</span><span class="va">TISSUE</span>,</span>
<span>                                     add_adj_p<span class="op">=</span><span class="cn">TRUE</span>, </span>
<span>                                     facet_by_sex<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>    <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>      <span class="kw">next</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="co"># log fold-changes</span></span>
<span>    <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_feature_logfc.html">plot_feature_logfc</a></span><span class="op">(</span>feature_ID<span class="op">=</span><span class="va">f</span>, </span>
<span>                           assay<span class="op">=</span><span class="st">"METAB"</span>,</span>
<span>                           tissue<span class="op">=</span><span class="va">TISSUE</span>,</span>
<span>                           facet_by_sex<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="key_metabolites_files/figure-html/single%20metab%202-1.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-2.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-3.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-4.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-5.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-6.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-7.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-8.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-9.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-10.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-11.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-12.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-13.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-14.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-15.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-16.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-17.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-18.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-19.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-20.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-21.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-22.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-23.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-24.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-25.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-26.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-27.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-28.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-29.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-30.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-31.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-32.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-33.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-34.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-35.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-36.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-37.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-38.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-39.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-40.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-41.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-42.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-43.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-44.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-45.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-46.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-47.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-48.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-49.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-50.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-51.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-52.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-53.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab%202-54.png" width="50%" height="50%" style="display: block; margin: auto;"></p>
<div class="section level3">
<h3 id="meaningful-ratios">Meaningful ratios<a class="anchor" aria-label="anchor" href="#meaningful-ratios"></a>
</h3>
<p>Let’s also plot some meaningful ratios. Here, we calculate the ratio
of the normalized sample-level data for two metabolites in matched
tissue samples. The y-axis then presents the average ratio across
samples within a given sex and training time point, where error bars are
standard deviation.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">my_plot_feature_normalized_data</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">assay</span> <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                           <span class="va">tissue</span> <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                           <span class="va">feature_ID</span> <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                           <span class="va">feature</span> <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                           <span class="va">title</span> <span class="op">=</span> <span class="cn">NULL</span>, </span>
<span>                                           <span class="va">add_gene_symbol</span> <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                           <span class="va">facet_by_sex</span> <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                           <span class="va">scale_x_by_time</span> <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                           <span class="va">return_data</span> <span class="op">=</span> <span class="cn">FALSE</span>, </span>
<span>                                           <span class="va">exclude_outliers</span> <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                           <span class="va">add_adj_p</span> <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">curr_feature</span> <span class="op">=</span> <span class="va">feature</span> </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">curr_feature</span><span class="op">)</span> <span class="op">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/any.html" class="external-link">any</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">assay</span>, <span class="va">tissue</span>, <span class="va">feature_ID</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="st">"If 'feature' is not specified, 'assay', 'tissue', and 'feature_ID' must all be specified."</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="co"># for metabolites, accommodate RefMet IDs</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">curr_feature</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">original_feature_ID</span> <span class="op">=</span> <span class="va">feature_ID</span></span>
<span>      <span class="kw">if</span><span class="op">(</span><span class="va">assay</span> <span class="op">==</span> <span class="st">"METAB"</span><span class="op">)</span><span class="op">{</span></span>
<span>        <span class="co"># check if feature_ID is valid </span></span>
<span>        <span class="va">m</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/METAB_FEATURE_ID_MAP.html">METAB_FEATURE_ID_MAP</a></span><span class="op">)</span></span>
<span>        <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="va">feature_ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">m</span><span class="op">[</span>,<span class="va">feature_ID_sample_data</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span>
<span>          <span class="co"># is it a RefMet ID?</span></span>
<span>          <span class="kw">if</span><span class="op">(</span><span class="va">feature_ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">m</span><span class="op">[</span>,<span class="va">metabolite_refmet</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span>
<span>            <span class="co"># get feature_ID used in data</span></span>
<span>            <span class="va">feature_ID</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">m</span><span class="op">[</span><span class="va">metabolite_refmet</span> <span class="op">==</span> <span class="va">feature_ID</span>, <span class="va">feature_ID_sample_data</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>          <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Feature ID '%s' not found in METAB data. See METAB_FEATURE_ID_MAP for measured metabolites."</span>, <span class="va">feature_ID</span><span class="op">)</span><span class="op">)</span></span>
<span>          <span class="op">}</span></span>
<span>        <span class="op">}</span></span>
<span>      <span class="op">}</span></span>
<span>      <span class="va">curr_feature</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s;%s;%s"</span>, <span class="va">assay</span>, <span class="va">tissue</span>, <span class="va">feature_ID</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>  </span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">tissue</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">splits</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unname.html" class="external-link">unname</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unlist.html" class="external-link">unlist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">curr_feature</span>, <span class="st">";"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>      <span class="va">assay</span> <span class="op">=</span> <span class="va">splits</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>      <span class="va">tissue</span> <span class="op">=</span> <span class="va">splits</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span>      <span class="va">feature_ID</span> <span class="op">=</span> <span class="va">splits</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span>      <span class="va">original_feature_ID</span> <span class="op">=</span> <span class="va">feature_ID</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">FEATURE_ID</span> <span class="op">=</span> <span class="va">feature_ID</span></span>
<span>    <span class="va">ASSAY</span> <span class="op">=</span> <span class="va">assay</span></span>
<span>    <span class="va">TISSUE</span> <span class="op">=</span> <span class="va">tissue</span></span>
<span>    <span class="va">FEATURE</span> <span class="op">=</span> <span class="va">curr_feature</span></span>
<span>    <span class="va">redundant_feature</span> <span class="op">=</span> <span class="va">FEATURE</span></span>
<span>    <span class="va">differential</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="va">training_reg</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRAINING_REGULATED_FEATURES.html">TRAINING_REGULATED_FEATURES</a></span><span class="op">)</span></span>
<span>    <span class="va">keep_looking</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="kw">while</span> <span class="op">(</span><span class="va">keep_looking</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">FEATURE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">training_reg</span><span class="op">[</span>, <span class="va">feature</span><span class="op">]</span><span class="op">)</span> </span>
<span>            <span class="kw">break</span></span>
<span>        <span class="va">differential</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">ASSAY</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"METAB"</span>, <span class="st">"IMMUNO"</span><span class="op">)</span><span class="op">)</span> </span>
<span>            <span class="kw">break</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">FEATURE</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/REPEATED_FEATURES.html">REPEATED_FEATURES</a></span><span class="op">$</span><span class="va">feature</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">FEATURE</span> <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/REPEATED_FEATURES.html">REPEATED_FEATURES</a></span><span class="op">$</span><span class="va">new_feature</span><span class="op">[</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/REPEATED_FEATURES.html">REPEATED_FEATURES</a></span><span class="op">$</span><span class="va">feature</span> <span class="op">==</span> </span>
<span>                <span class="va">FEATURE</span><span class="op">]</span></span>
<span>            <span class="va">differential</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>            <span class="va">FEATURE_ID</span> <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/REPEATED_FEATURES.html">REPEATED_FEATURES</a></span><span class="op">$</span><span class="va">feature_ID</span><span class="op">[</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/REPEATED_FEATURES.html">REPEATED_FEATURES</a></span><span class="op">$</span><span class="va">new_feature</span> <span class="op">==</span> </span>
<span>                <span class="va">FEATURE</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></span>
<span>            <span class="kw">break</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">ASSAY</span> <span class="op">==</span> <span class="st">"METAB"</span><span class="op">)</span> </span>
<span>            <span class="kw">break</span></span>
<span>        <span class="va">new_feature_id</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/METAB_FEATURE_ID_MAP.html">METAB_FEATURE_ID_MAP</a></span><span class="op">$</span><span class="va">feature_ID_metareg</span><span class="op">[</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/METAB_FEATURE_ID_MAP.html">METAB_FEATURE_ID_MAP</a></span><span class="op">$</span><span class="va">metabolite_name</span> <span class="op">==</span> </span>
<span>            <span class="va">FEATURE_ID</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="va">new_feature_id</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">new_feature_id</span><span class="op">[</span><span class="va">new_feature_id</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>            <span class="va">training_reg</span><span class="op">[</span><span class="va">assay</span> <span class="op">==</span> <span class="va">ASSAY</span> <span class="op">&amp;</span> <span class="va">tissue</span> <span class="op">==</span> <span class="va">TISSUE</span>, <span class="va">feature_ID</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">new_feature_id</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> </span>
<span>            <span class="kw">break</span></span>
<span>        <span class="va">FEATURE</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">training_reg</span><span class="op">[</span><span class="va">feature_ID</span> <span class="op">==</span> <span class="va">new_feature_id</span> <span class="op">&amp;</span> </span>
<span>            <span class="va">tissue</span> <span class="op">==</span> <span class="va">TISSUE</span> <span class="op">&amp;</span> <span class="va">assay</span> <span class="op">==</span> <span class="va">ASSAY</span>, <span class="va">feature</span><span class="op">]</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">FEATURE</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> </span>
<span>            <span class="kw">break</span></span>
<span>        <span class="va">differential</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>        <span class="va">keep_looking</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">differential</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">exclude_outliers</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">all_sample_level_data</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRAINING_REGULATED_NORM_DATA.html">TRAINING_REGULATED_NORM_DATA_NO_OUTLIERS</a></span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">all_sample_level_data</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRAINING_REGULATED_NORM_DATA.html">TRAINING_REGULATED_NORM_DATA</a></span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="va">sample_level_data</span> <span class="op">=</span> <span class="va">all_sample_level_data</span><span class="op">[</span><span class="va">feature</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> </span>
<span>            <span class="va">FEATURE</span><span class="op">]</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"'%s' is not a training-regulated feature. Looking in all sample-level data."</span>, </span>
<span>            <span class="va">FEATURE</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">all_sample_level_data</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu"><a href="../reference/load_sample_data.html">load_sample_data</a></span><span class="op">(</span><span class="va">TISSUE</span>, </span>
<span>            <span class="va">ASSAY</span>, exclude_outliers <span class="op">=</span> <span class="va">exclude_outliers</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">all_sample_level_data</span><span class="op">)</span> <span class="op">==</span> <span class="fl">0</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sample-level data for %s %s not found."</span>, </span>
<span>                <span class="va">ASSAY</span>, <span class="va">TISSUE</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">FEATURE_ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">all_sample_level_data</span><span class="op">[</span>, <span class="va">feature_ID</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"'%s' not found in the %s %s sample-level data."</span>, </span>
<span>                <span class="va">FEATURE_ID</span>, <span class="va">ASSAY</span>, <span class="va">TISSUE</span><span class="op">)</span><span class="op">)</span></span>
<span>            <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="va">sample_level_data</span> <span class="op">=</span> <span class="va">all_sample_level_data</span><span class="op">[</span><span class="va">feature_ID</span> <span class="op">==</span> </span>
<span>            <span class="va">FEATURE_ID</span><span class="op">]</span></span>
<span>        <span class="va">sample_level_data</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">feature</span><span class="op">)</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">feature</span>, <span class="va">FEATURE</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">multiple_measurements</span> <span class="op">=</span> <span class="cn">FALSE</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">nrow</a></span><span class="op">(</span><span class="va">sample_level_data</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/warning.html" class="external-link">warning</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Multiple features correspond to '%s'. Plotting them together."</span>, </span>
<span>            <span class="va">redundant_feature</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">sample_level_data</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">feature</span>, <span class="va">dataset</span><span class="op">)</span><span class="op">]</span></span>
<span>        <span class="va">multiple_measurements</span> <span class="op">=</span> <span class="cn">TRUE</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">add_gene_symbol</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">ASSAY</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"METHYL"</span>, <span class="st">"ATAC"</span><span class="op">)</span> <span class="op">&amp;</span> <span class="op">!</span><span class="va">differential</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">feature_to_gene</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/FEATURE_TO_GENE.html">FEATURE_TO_GENE</a></span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">feature_to_gene</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/FEATURE_TO_GENE_FILT.html">FEATURE_TO_GENE_FILT</a></span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="va">gene_symbol</span> <span class="op">=</span> <span class="va">feature_to_gene</span><span class="op">[</span><span class="va">feature_ID</span> <span class="op">==</span> <span class="va">FEATURE_ID</span>, </span>
<span>            <span class="va">gene_symbol</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">title</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">add_gene_symbol</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">title</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s (%s)"</span>, <span class="va">redundant_feature</span>, <span class="va">gene_symbol</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">title</span> <span class="op">=</span> <span class="va">redundant_feature</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="va">add_gene_symbol</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">title</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s (%s)"</span>, <span class="va">title</span>, <span class="va">gene_symbol</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">value_cols</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sample_level_data</span><span class="op">)</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grepl</a></span><span class="op">(</span><span class="st">"^[0-9]"</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">sample_level_data</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">melted_subset</span> <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/melt.data.table.html" class="external-link">melt</a></span><span class="op">(</span><span class="va">sample_level_data</span>, id.vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"feature"</span><span class="op">)</span>, </span>
<span>        measure.vars <span class="op">=</span> <span class="va">value_cols</span>, variable.name <span class="op">=</span> <span class="st">"sample"</span><span class="op">)</span></span>
<span>    <span class="va">melted_subset</span> <span class="op">=</span> <span class="va">melted_subset</span><span class="op">[</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">value</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">melted_subset</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">sample</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">sample</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="va">meta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html" class="external-link">as.data.table</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/PHENO.html">PHENO</a></span><span class="op">[</span>, </span>
<span>        <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"group"</span>, <span class="st">"sex"</span>, <span class="st">"pid"</span>, <span class="st">"viallabel"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">meta</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">pid</span>, <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="va">pid</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">melted_subset</span><span class="op">[</span>, <span class="va">sample</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">meta</span><span class="op">[</span>, <span class="va">viallabel</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">col</span> <span class="op">=</span> <span class="st">"viallabel"</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/all.html" class="external-link">all</a></span><span class="op">(</span><span class="va">melted_subset</span><span class="op">[</span>, <span class="va">sample</span><span class="op">]</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">meta</span><span class="op">[</span>, <span class="va">pid</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">col</span> <span class="op">=</span> <span class="st">"pid"</span></span>
<span>        <span class="va">meta</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">viallabel</span>, <span class="cn">NULL</span><span class="op">)</span><span class="op">]</span></span>
<span>        <span class="va">meta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">meta</span><span class="op">)</span></span>
<span>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/stop.html" class="external-link">stop</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Sample names in sample-level data do not correspond to vial labels or PIDs: %s..."</span>, </span>
<span>            <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">melted_subset</span><span class="op">[</span>, <span class="va">sample</span><span class="op">]</span><span class="op">)</span>, collapse <span class="op">=</span> <span class="st">", "</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">subset_meta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">melted_subset</span>, <span class="va">meta</span>, by.x <span class="op">=</span> <span class="st">"sample"</span>, </span>
<span>        by.y <span class="op">=</span> <span class="va">col</span><span class="op">)</span></span>
<span>    <span class="va">bygroup</span> <span class="op">=</span> <span class="va">subset_meta</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>expr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>, </span>
<span>        sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">value</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>, by <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="va">sex</span>, <span class="va">group</span>, <span class="va">feature</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">add_adj_p</span><span class="op">)</span> <span class="op">{</span></span>
<span>      <span class="va">adj_p_value</span> <span class="op">=</span> <span class="cn">NULL</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/message.html" class="external-link">message</a></span><span class="op">(</span><span class="st">"Adding differential analysis p-value..."</span><span class="op">)</span></span>
<span>      <span class="va">da</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_feature_logfc.html">plot_feature_logfc</a></span><span class="op">(</span>assay <span class="op">=</span> <span class="va">ASSAY</span>, tissue <span class="op">=</span> <span class="va">TISSUE</span>, </span>
<span>          feature_ID <span class="op">=</span> <span class="va">feature_ID</span>, add_adj_p <span class="op">=</span> <span class="cn">TRUE</span>, return_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">da</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>          <span class="va">adj_p_value</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">da</span><span class="op">$</span><span class="va">selection_fdr</span><span class="op">)</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>      <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">return_data</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">subset_meta</span><span class="op">[</span>,<span class="va">selection_fdr</span> <span class="op">:=</span> <span class="va">adj_p_value</span><span class="op">]</span></span>
<span>        <span class="va">bygroup</span><span class="op">[</span>,<span class="va">selection_fdr</span> <span class="op">:=</span> <span class="va">adj_p_value</span><span class="op">]</span></span>
<span>        <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>by_sample <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">subset_meta</span><span class="op">)</span>,</span>
<span>                    by_group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="va">bygroup</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="va">bygroup</span><span class="op">[</span>, <span class="fu">`:=`</span><span class="op">(</span><span class="va">plot_group</span>, <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s_%s"</span>, <span class="va">feature</span>, <span class="va">sex</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">multiple_measurements</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">facet_by_sex</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bygroup</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, </span>
<span>                y <span class="op">=</span> <span class="va">expr</span>, group <span class="op">=</span> <span class="va">plot_group</span>, colour <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fl">2</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">feature</span><span class="op">)</span>, </span>
<span>                  position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">expr</span> <span class="op">-</span> </span>
<span>                  <span class="va">sd</span>, ymax <span class="op">=</span> <span class="va">expr</span> <span class="op">+</span> <span class="va">sd</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>female <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/SEX_COLORS.html">SEX_COLORS</a></span><span class="op">[[</span><span class="st">"F"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                male <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/SEX_COLORS.html">SEX_COLORS</a></span><span class="op">[[</span><span class="st">"M"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time trained (weeks)"</span>, y <span class="op">=</span> <span class="st">"Normalized value"</span>, </span>
<span>                  title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>                legend.position <span class="op">=</span> <span class="st">"top"</span>, panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                legend.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, b <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, </span>
<span>                  unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span>, legend.spacing.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                  <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bygroup</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, </span>
<span>                y <span class="op">=</span> <span class="va">expr</span>, group <span class="op">=</span> <span class="va">plot_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_COLORS.html">TISSUE_COLORS</a></span><span class="op">[[</span><span class="va">TISSUE</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_COLORS.html">TISSUE_COLORS</a></span><span class="op">[[</span><span class="va">TISSUE</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>shape <span class="op">=</span> <span class="va">feature</span><span class="op">)</span>, position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span>, </span>
<span>                  size <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">expr</span> <span class="op">-</span> </span>
<span>                <span class="va">sd</span>, ymax <span class="op">=</span> <span class="va">expr</span> <span class="op">+</span> <span class="va">sd</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span>, colour <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_COLORS.html">TISSUE_COLORS</a></span><span class="op">[[</span><span class="va">TISSUE</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time trained (weeks)"</span>, </span>
<span>                y <span class="op">=</span> <span class="st">"Normalized value"</span>, title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>                legend.position <span class="op">=</span> <span class="st">"top"</span>, panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                legend.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, b <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, </span>
<span>                  unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="va">facet_by_sex</span><span class="op">)</span> <span class="op">{</span></span>
<span>            <span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bygroup</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, </span>
<span>                y <span class="op">=</span> <span class="va">expr</span>, group <span class="op">=</span> <span class="va">plot_group</span>, colour <span class="op">=</span> <span class="va">sex</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">expr</span> <span class="op">-</span> </span>
<span>                  <span class="va">sd</span>, ymax <span class="op">=</span> <span class="va">expr</span> <span class="op">+</span> <span class="va">sd</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span>, position <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span>female <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/SEX_COLORS.html">SEX_COLORS</a></span><span class="op">[[</span><span class="st">"F"</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                male <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/SEX_COLORS.html">SEX_COLORS</a></span><span class="op">[[</span><span class="st">"M"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time trained (weeks)"</span>, y <span class="op">=</span> <span class="st">"Normalized value"</span>, </span>
<span>                  title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>                legend.position <span class="op">=</span> <span class="st">"top"</span>, panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                legend.margin <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">margin</a></span><span class="op">(</span>t <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, b <span class="op">=</span> <span class="op">-</span><span class="fl">5</span>, </span>
<span>                  unit <span class="op">=</span> <span class="st">"pt"</span><span class="op">)</span>, legend.spacing.y <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/grid/unit.html" class="external-link">unit</a></span><span class="op">(</span><span class="fl">0</span>, </span>
<span>                  <span class="st">"pt"</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>        <span class="kw">else</span> <span class="op">{</span></span>
<span>            <span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">bygroup</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">group</span>, </span>
<span>                y <span class="op">=</span> <span class="va">expr</span>, group <span class="op">=</span> <span class="va">plot_group</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_COLORS.html">TISSUE_COLORS</a></span><span class="op">[[</span><span class="va">TISSUE</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_COLORS.html">TISSUE_COLORS</a></span><span class="op">[[</span><span class="va">TISSUE</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin <span class="op">=</span> <span class="va">expr</span> <span class="op">-</span> <span class="va">sd</span>, </span>
<span>                  ymax <span class="op">=</span> <span class="va">expr</span> <span class="op">+</span> <span class="va">sd</span><span class="op">)</span>, width <span class="op">=</span> <span class="fl">0.2</span>, colour <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_COLORS.html">TISSUE_COLORS</a></span><span class="op">[[</span><span class="va">TISSUE</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Time trained (weeks)"</span>, </span>
<span>                y <span class="op">=</span> <span class="st">"Normalized value"</span>, title <span class="op">=</span> <span class="va">title</span><span class="op">)</span> <span class="op">+</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, </span>
<span>                size <span class="op">=</span> <span class="fl">11</span><span class="op">)</span>, legend.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>, </span>
<span>                legend.position <span class="op">=</span> <span class="st">"none"</span>, panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>, </span>
<span>                panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>                <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span></span>
<span>        <span class="op">}</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">scale_x_by_time</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">g</span> <span class="op">=</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"1w"</span>, </span>
<span>            <span class="st">"2w"</span>, <span class="st">"fill"</span>, <span class="st">"4w"</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"fill"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="st">"8w"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, </span>
<span>            <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"4"</span>, <span class="st">"8"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"1w"</span>, </span>
<span>            <span class="st">"2w"</span>, <span class="st">"4w"</span>, <span class="st">"8w"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="kw">else</span> <span class="op">{</span></span>
<span>        <span class="va">g</span> <span class="op">=</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"1w"</span>, </span>
<span>            <span class="st">"2w"</span>, <span class="st">"4w"</span>, <span class="st">"8w"</span><span class="op">)</span>, labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"0"</span>, <span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"4"</span>, </span>
<span>            <span class="st">"8"</span><span class="op">)</span>, breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"control"</span>, <span class="st">"1w"</span>, <span class="st">"2w"</span>, <span class="st">"4w"</span>, <span class="st">"8w"</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw">if</span> <span class="op">(</span><span class="va">add_adj_p</span> <span class="op">&amp;</span> <span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">adj_p_value</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>        <span class="va">subtitle</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"adj. p-value: %s"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">adj_p_value</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>        <span class="va">g</span> <span class="op">=</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle <span class="op">=</span> <span class="va">subtitle</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    </span>
<span>    <span class="kw"><a href="https://rdrr.io/r/base/function.html" class="external-link">return</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<div class="section level4">
<h4 id="nadnadh">NAD+/NADH<a class="anchor" aria-label="anchor" href="#nadnadh"></a>
</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get all sample-level data</span></span>
<span><span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NADH"</span>,<span class="st">"NAD+"</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">tissue</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"SKM-GN"</span>,<span class="st">"SKM-VL"</span>,<span class="st">"PLASMA"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">subdat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">feat</span> <span class="kw">in</span> <span class="va">features</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">=</span> <span class="fu">my_plot_feature_normalized_data</span><span class="op">(</span>feature_ID<span class="op">=</span><span class="va">feat</span>, </span>
<span>                                         tissue<span class="op">=</span><span class="va">tissue</span>,</span>
<span>                                         assay<span class="op">=</span><span class="st">"METAB"</span>,</span>
<span>                                         add_adj_p <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                         return_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">by_sample</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span> <span class="kw">next</span></span>
<span>    <span class="va">dat</span><span class="op">$</span><span class="va">feature_ID</span> <span class="op">=</span> <span class="va">feat</span></span>
<span>    <span class="va">dat</span><span class="op">$</span><span class="va">tissue</span> <span class="op">=</span> <span class="va">tissue</span></span>
<span>    <span class="va">subdat</span><span class="op">[[</span><span class="va">feat</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">dat</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># add ratio</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="kw">next</span></span>
<span>  <span class="va">merged</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">subdat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>,<span class="st">"group"</span>,<span class="st">"sample"</span>,<span class="st">"tissue"</span>,<span class="st">"feature"</span><span class="op">)</span>, </span>
<span>                 suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">merged</span><span class="op">$</span><span class="va">NAD_NADH</span> <span class="op">=</span> <span class="va">merged</span><span class="op">$</span><span class="va">`value_NAD+`</span><span class="op">/</span><span class="va">merged</span><span class="op">$</span><span class="va">value_NADH</span></span>
<span>  <span class="va">merged</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">merged</span><span class="op">)</span></span>
<span></span>
<span>  <span class="va">by_group</span> <span class="op">=</span> <span class="va">merged</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>NAD_NADH <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">NAD_NADH</span><span class="op">)</span>,</span>
<span>                          NAD_NADH_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">NAD_NADH</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  by<span class="op">=</span><span class="fu">.</span><span class="op">(</span><span class="va">sex</span>, <span class="va">group</span>, <span class="va">feature</span>, <span class="va">tissue</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">by_group</span><span class="op">[</span>,<span class="va">plotting_group</span> <span class="op">:=</span> <span class="va">feature</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">platform</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">by_group</span><span class="op">[</span>,<span class="va">feature</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">by_group</span><span class="op">[</span><span class="va">feature</span> <span class="op">==</span> <span class="va">platform</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">NAD_NADH</span>, x<span class="op">=</span><span class="va">group</span>, group<span class="op">=</span><span class="va">plotting_group</span>, color<span class="op">=</span><span class="va">tissue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">NAD_NADH</span><span class="op">-</span><span class="va">NAD_NADH_sd</span>, ymax<span class="op">=</span><span class="va">NAD_NADH</span><span class="op">+</span><span class="va">NAD_NADH_sd</span><span class="op">)</span>,</span>
<span>                             width<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>                             position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>,linetype<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s NAD+/NADH"</span>, <span class="va">tissue</span><span class="op">)</span>, x<span class="op">=</span><span class="st">"Time trained (weeks)"</span>, y<span class="op">=</span><span class="st">"Ratio"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                     plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                     panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">TISSUE_COLORS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TISSUE_COLORS</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">by_group</span><span class="op">[</span>,<span class="va">tissue</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                   name<span class="op">=</span><span class="st">"Tissue"</span>, guide<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'control'</span>,<span class="st">'1w'</span>,<span class="st">'2w'</span>,<span class="st">'fill'</span>,<span class="st">'4w'</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'fill'</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">'8w'</span><span class="op">)</span>,</span>
<span>                       labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'0'</span>,<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'4'</span>,<span class="st">'8'</span><span class="op">)</span>,</span>
<span>                       breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'control'</span>,<span class="st">'1w'</span>,<span class="st">'2w'</span>,<span class="st">'4w'</span>,<span class="st">'8w'</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">by_group</span><span class="op">[</span>,<span class="va">feature</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">g</span> <span class="op">=</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Measured by %s"</span>,<span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="key_metabolites_files/figure-html/NAD/NADH-1.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/NAD/NADH-2.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/NAD/NADH-3.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/NAD/NADH-4.png" width="50%" height="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="lactatepyruvate">Lactate/pyruvate<a class="anchor" aria-label="anchor" href="#lactatepyruvate"></a>
</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get all sample-level data</span></span>
<span><span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Lactic acid"</span>,<span class="st">"Pyruvic acid"</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">tissue</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"SKM-GN"</span>,<span class="st">"SKM-VL"</span>,<span class="st">"PLASMA"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">subdat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">feat</span> <span class="kw">in</span> <span class="va">features</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">=</span> <span class="fu">my_plot_feature_normalized_data</span><span class="op">(</span>feature_ID<span class="op">=</span><span class="va">feat</span>, </span>
<span>                                          tissue<span class="op">=</span><span class="va">tissue</span>,</span>
<span>                                          assay<span class="op">=</span><span class="st">"METAB"</span>,</span>
<span>                                          add_adj_p <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          return_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">by_sample</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span> <span class="kw">next</span></span>
<span>    <span class="va">dat</span><span class="op">$</span><span class="va">feature_ID</span> <span class="op">=</span> <span class="va">feat</span></span>
<span>    <span class="va">dat</span><span class="op">$</span><span class="va">tissue</span> <span class="op">=</span> <span class="va">tissue</span></span>
<span>    <span class="va">subdat</span><span class="op">[[</span><span class="va">feat</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">dat</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># add ratio</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="kw">next</span></span>
<span>  <span class="va">merged</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">subdat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>,<span class="st">"group"</span>,<span class="st">"sample"</span>,<span class="st">"tissue"</span><span class="op">)</span>, </span>
<span>                 suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">merged</span><span class="op">$</span><span class="va">lactate_pyruvate</span> <span class="op">=</span> <span class="va">merged</span><span class="op">$</span><span class="va">`value_Lactic acid`</span><span class="op">/</span><span class="va">merged</span><span class="op">$</span><span class="va">`value_Pyruvic acid`</span></span>
<span>  <span class="va">merged</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">merged</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># lactate is measured on a single platform, but pyruvate is only measured on one</span></span>
<span>  <span class="va">by_group</span> <span class="op">=</span> <span class="va">merged</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>lactate_pyruvate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">lactate_pyruvate</span><span class="op">)</span>,</span>
<span>                          lactate_pyruvate_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">lactate_pyruvate</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  by<span class="op">=</span><span class="fu">.</span><span class="op">(</span><span class="va">sex</span>, <span class="va">group</span>, <span class="va">`feature_Lactic acid`</span>, <span class="va">tissue</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">by_group</span><span class="op">[</span>,<span class="va">plotting_group</span> <span class="op">:=</span> <span class="va">`feature_Lactic acid`</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">platform</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">by_group</span><span class="op">[</span>,<span class="va">plotting_group</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">by_group</span><span class="op">[</span><span class="va">plotting_group</span> <span class="op">==</span> <span class="va">platform</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">lactate_pyruvate</span>, x<span class="op">=</span><span class="va">group</span>, group<span class="op">=</span><span class="va">plotting_group</span>, color<span class="op">=</span><span class="va">tissue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">lactate_pyruvate</span><span class="op">-</span><span class="va">lactate_pyruvate_sd</span>, ymax<span class="op">=</span><span class="va">lactate_pyruvate</span><span class="op">+</span><span class="va">lactate_pyruvate_sd</span><span class="op">)</span>,</span>
<span>                             width<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>                             position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>,linetype<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s lactate/pyruvate"</span>, <span class="va">tissue</span><span class="op">)</span>, </span>
<span>                    x<span class="op">=</span><span class="st">"Time trained (weeks)"</span>, </span>
<span>                    y<span class="op">=</span><span class="st">"Ratio"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                     plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                     panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">TISSUE_COLORS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TISSUE_COLORS</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">by_group</span><span class="op">[</span>,<span class="va">tissue</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                   name<span class="op">=</span><span class="st">"Tissue"</span>,</span>
<span>                                   guide<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'control'</span>,<span class="st">'1w'</span>,<span class="st">'2w'</span>,<span class="st">'fill'</span>,<span class="st">'4w'</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'fill'</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">'8w'</span><span class="op">)</span>,</span>
<span>                       labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'0'</span>,<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'4'</span>,<span class="st">'8'</span><span class="op">)</span>,</span>
<span>                       breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'control'</span>,<span class="st">'1w'</span>,<span class="st">'2w'</span>,<span class="st">'4w'</span>,<span class="st">'8w'</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">by_group</span><span class="op">[</span>,<span class="va">plotting_group</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>      <span class="va">g</span> <span class="op">=</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Lactate measured by %s"</span>,<span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="op">}</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="key_metabolites_files/figure-html/lactate/pyruvate-1.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/lactate/pyruvate-2.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/lactate/pyruvate-3.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/lactate/pyruvate-4.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/lactate/pyruvate-5.png" width="50%" height="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level4">
<h4 id="ampatp">AMP/ATP<a class="anchor" aria-label="anchor" href="#ampatp"></a>
</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># get all sample-level data</span></span>
<span><span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"AMP"</span>,<span class="st">"ATP"</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">tissue</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"SKM-GN"</span>,<span class="st">"SKM-VL"</span>,<span class="st">"PLASMA"</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">subdat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">feat</span> <span class="kw">in</span> <span class="va">features</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">dat</span> <span class="op">=</span> <span class="fu">my_plot_feature_normalized_data</span><span class="op">(</span>feature_ID<span class="op">=</span><span class="va">feat</span>, </span>
<span>                                          tissue<span class="op">=</span><span class="va">tissue</span>,</span>
<span>                                          assay<span class="op">=</span><span class="st">"METAB"</span>,</span>
<span>                                          add_adj_p <span class="op">=</span> <span class="cn">TRUE</span>, </span>
<span>                                          return_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">by_sample</span></span>
<span>    <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">dat</span><span class="op">)</span><span class="op">)</span> <span class="kw">next</span></span>
<span>    <span class="va">dat</span><span class="op">$</span><span class="va">feature_ID</span> <span class="op">=</span> <span class="va">feat</span></span>
<span>    <span class="va">dat</span><span class="op">$</span><span class="va">tissue</span> <span class="op">=</span> <span class="va">tissue</span></span>
<span>    <span class="va">subdat</span><span class="op">[[</span><span class="va">feat</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">dat</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># add ratio</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">)</span> <span class="op">&lt;</span> <span class="fl">2</span><span class="op">)</span> <span class="kw">next</span></span>
<span>  <span class="va">merged</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="va">subdat</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, by<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>,<span class="st">"group"</span>,<span class="st">"sample"</span>,<span class="st">"tissue"</span>,<span class="st">"feature"</span><span class="op">)</span>, </span>
<span>                 suffixes <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">subdat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="va">merged</span><span class="op">$</span><span class="va">amp_atp</span> <span class="op">=</span> <span class="va">merged</span><span class="op">$</span><span class="va">`value_AMP`</span><span class="op">/</span><span class="va">merged</span><span class="op">$</span><span class="va">`value_ATP`</span></span>
<span>  <span class="va">merged</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="va">merged</span><span class="op">)</span></span>
<span></span>
<span>  <span class="co"># AMP is measured on 3 platforms; ATP is measured on 2 platforms</span></span>
<span>  <span class="co"># just use data from overlapping platforms</span></span>
<span>  <span class="va">by_group</span> <span class="op">=</span> <span class="va">merged</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>amp_atp <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html" class="external-link">mean</a></span><span class="op">(</span><span class="va">amp_atp</span><span class="op">)</span>,</span>
<span>                          amp_atp_sd <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html" class="external-link">sd</a></span><span class="op">(</span><span class="va">amp_atp</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                  by<span class="op">=</span><span class="fu">.</span><span class="op">(</span><span class="va">sex</span>, <span class="va">group</span>, <span class="va">tissue</span>, <span class="va">feature</span><span class="op">)</span><span class="op">]</span></span>
<span>  </span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">platform</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">by_group</span><span class="op">[</span>,<span class="va">feature</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">by_group</span><span class="op">[</span><span class="va">feature</span> <span class="op">==</span> <span class="va">platform</span><span class="op">]</span><span class="op">)</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">amp_atp</span>, x<span class="op">=</span><span class="va">group</span>, group<span class="op">=</span><span class="va">feature</span>, color<span class="op">=</span><span class="va">tissue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">amp_atp</span><span class="op">-</span><span class="va">amp_atp_sd</span>, ymax<span class="op">=</span><span class="va">amp_atp</span><span class="op">+</span><span class="va">amp_atp_sd</span><span class="op">)</span>,</span>
<span>                             width<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>                             position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>,linetype<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s AMP/ATP"</span>, <span class="va">tissue</span><span class="op">)</span>, </span>
<span>                    x<span class="op">=</span><span class="st">"Time trained (weeks)"</span>, </span>
<span>                    y<span class="op">=</span><span class="st">"Ratio"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                     plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                     panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                     panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">TISSUE_COLORS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TISSUE_COLORS</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">by_group</span><span class="op">[</span>,<span class="va">tissue</span><span class="op">]</span><span class="op">]</span>,</span>
<span>                                   name<span class="op">=</span><span class="st">"Tissue"</span>,</span>
<span>                                   guide<span class="op">=</span><span class="st">"none"</span><span class="op">)</span> <span class="op">+</span></span>
<span>      <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'control'</span>,<span class="st">'1w'</span>,<span class="st">'2w'</span>,<span class="st">'fill'</span>,<span class="st">'4w'</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'fill'</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">'8w'</span><span class="op">)</span>,</span>
<span>                       labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'0'</span>,<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'4'</span>,<span class="st">'8'</span><span class="op">)</span>,</span>
<span>                       breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'control'</span>,<span class="st">'1w'</span>,<span class="st">'2w'</span>,<span class="st">'4w'</span>,<span class="st">'8w'</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">g</span> <span class="op">=</span> <span class="va">g</span> <span class="op">+</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>subtitle<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"Measured by %s"</span>,<span class="va">platform</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="key_metabolites_files/figure-html/amp/atp-1.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/amp/atp-2.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/amp/atp-3.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/amp/atp-4.png" width="50%" height="50%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="metabolites-manually-selected-from-full-list-of-differential-metabolites">Metabolites manually selected from full list of differential
metabolites<a class="anchor" aria-label="anchor" href="#metabolites-manually-selected-from-full-list-of-differential-metabolites"></a>
</h2>
<p>Now, let’s plot individual metabolites. Each of these metabolites are
significantly training-regulated at 5% FDR. These were manually selected
as potentially interesting metabolites to highlight from the full list
of differential metabolites. For each metabolite, the trajectory of the
normalized sample-level data is shown on the left, and the log
fold-changes from the timewise differential analysis are shown on the
right. Multiple traces are shown if multiple platforms measured the
metabolite.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">v1</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="st">"differential_metabolites_1.txt"</span><span class="op">)</span></span>
<span><span class="va">v2</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/fread.html" class="external-link">fread</a></span><span class="op">(</span><span class="st">"differential_metabolites_2.txt"</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metabolites</span> <span class="op">=</span> <span class="va">v1</span><span class="op">[</span><span class="va">plot</span><span class="op">==</span><span class="st">"X"</span>, <span class="va">feature</span><span class="op">]</span></span>
<span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="va">metabolites</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>  <span class="co"># sample-level data</span></span>
<span>  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_feature_normalized_data.html">plot_feature_normalized_data</a></span><span class="op">(</span>feature<span class="op">=</span><span class="va">m</span>, add_adj_p<span class="op">=</span><span class="cn">TRUE</span>, facet_by_sex<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="op">}</span><span class="kw">else</span><span class="op">{</span></span>
<span>    <span class="kw">next</span></span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="co"># log fold-changes</span></span>
<span>  <span class="va">p</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_feature_logfc.html">plot_feature_logfc</a></span><span class="op">(</span>feature<span class="op">=</span><span class="va">m</span>, facet_by_sex<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NULL.html" class="external-link">is.null</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="key_metabolites_files/figure-html/single%20metab-1.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-2.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-3.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-4.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-5.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-6.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-7.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-8.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-9.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-10.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-11.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-12.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-13.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-14.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-15.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-16.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-17.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-18.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-19.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-20.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-21.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-22.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-23.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-24.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-25.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-26.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-27.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-28.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-29.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-30.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-31.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-32.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-33.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-34.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-35.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-36.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-37.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-38.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-39.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-40.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-41.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-42.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-43.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-44.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-45.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-46.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-47.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-48.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-49.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-50.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-51.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-52.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-53.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-54.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-55.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-56.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-57.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-58.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-59.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-60.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-61.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-62.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-63.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-64.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-65.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-66.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-67.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-68.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-69.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-70.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-71.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-72.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-73.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-74.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-75.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-76.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-77.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-78.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-79.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-80.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-81.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-82.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-83.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-84.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-85.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-86.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-87.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-88.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-89.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-90.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-91.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-92.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-93.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-94.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-95.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-96.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-97.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-98.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-99.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-100.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-101.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-102.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-103.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-104.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-105.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-106.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-107.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-108.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-109.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-110.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-111.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-112.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-113.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-114.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-115.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-116.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-117.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-118.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-119.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-120.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-121.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-122.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-123.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-124.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-125.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-126.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-127.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-128.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-129.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-130.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-131.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-132.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-133.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-134.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-135.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-136.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-137.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-138.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-139.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-140.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-141.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-142.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-143.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-144.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-145.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-146.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-147.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-148.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-149.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-150.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-151.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-152.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-153.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-154.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-155.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-156.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-157.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-158.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-159.png" width="50%" height="50%" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/single%20metab-160.png" width="50%" height="50%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="metabolites-training-regulated-in-many-tissues">Metabolites training-regulated in many tissues<a class="anchor" aria-label="anchor" href="#metabolites-training-regulated-in-many-tissues"></a>
</h2>
<p>Finally, let’s plot some metabolites that are differential in many
tissues. We include metabolites from above that were training-regulated
in multiple tissues as well as all metabolites that are
training-regulated in at least 8 tissues. Trajectories of log
fold-changes from the timewise differential analysis are shown, with
traces colored by tissue. The training adjusted p-values, which were
used to select differential features at 5% FDR, are indicated in the
legend.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">featureIDs</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">v1</span><span class="op">[</span><span class="va">plot</span><span class="op">==</span><span class="st">"X"</span>, <span class="va">feature_ID</span><span class="op">]</span>, <span class="va">v2</span><span class="op">[</span><span class="va">plot</span><span class="op">==</span><span class="st">"X"</span>, <span class="va">feature_ID</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span><span class="op">(</span><span class="va">f</span> <span class="kw">in</span> <span class="va">featureIDs</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># get all training-regulated features</span></span>
<span>  <span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">TRAINING_REGULATED_FEATURES</span><span class="op">$</span><span class="va">feature</span><span class="op">[</span><span class="va">TRAINING_REGULATED_FEATURES</span><span class="op">$</span><span class="va">feature_ID</span><span class="op">==</span><span class="va">f</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">features</span><span class="op">)</span> <span class="op">&lt;=</span> <span class="fl">1</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="kw">next</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="co"># get all logFCs</span></span>
<span>  <span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="kw">for</span><span class="op">(</span><span class="va">feat</span> <span class="kw">in</span> <span class="va">features</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">data</span><span class="op">[[</span><span class="va">feat</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="../reference/plot_feature_logfc.html">plot_feature_logfc</a></span><span class="op">(</span>feature<span class="op">=</span><span class="va">feat</span>, add_adj_p <span class="op">=</span> <span class="cn">TRUE</span>, return_data <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">data</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html" class="external-link">rbindlist</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">data</span><span class="op">[</span>,<span class="va">plotting_group</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="va">tissue</span>,<span class="va">feature</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="co"># add adj p to legend</span></span>
<span>  <span class="va">data</span><span class="op">[</span>,<span class="va">tissue_p</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%s (%s)"</span>, <span class="va">tissue</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">signif</a></span><span class="op">(</span><span class="va">selection_fdr</span>, digits<span class="op">=</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span><span class="op">]</span></span>
<span>  <span class="va">labels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="va">tissue_p</span><span class="op">]</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">labels</span><span class="op">)</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">" .*"</span>,<span class="st">""</span>,<span class="va">labels</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">data_df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">data</span><span class="op">)</span></span>
<span>  <span class="va">g</span> <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">data_df</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>y<span class="op">=</span><span class="va">logFC</span>, x<span class="op">=</span><span class="va">comparison_group</span>, group<span class="op">=</span><span class="va">plotting_group</span>, color<span class="op">=</span><span class="va">tissue</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html" class="external-link">geom_point</a></span><span class="op">(</span>size<span class="op">=</span><span class="fl">2</span>, position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span>position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_linerange.html" class="external-link">geom_errorbar</a></span><span class="op">(</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>ymin<span class="op">=</span><span class="va">logFC</span><span class="op">-</span><span class="va">logFC_se</span>, ymax<span class="op">=</span><span class="va">logFC</span><span class="op">+</span><span class="va">logFC_se</span><span class="op">)</span>,</span>
<span>                           width<span class="op">=</span><span class="fl">0.2</span>, </span>
<span>                           position<span class="op">=</span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html" class="external-link">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.3</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html" class="external-link">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html" class="external-link">geom_hline</a></span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">0</span>,linetype<span class="op">=</span><span class="st">"dotted"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/facet_wrap.html" class="external-link">facet_wrap</a></span><span class="op">(</span><span class="op">~</span><span class="va">sex</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html" class="external-link">labs</a></span><span class="op">(</span>title<span class="op">=</span><span class="va">f</span>, x<span class="op">=</span><span class="st">"Time trained (weeks)"</span>, y<span class="op">=</span><span class="st">"Log fold-change"</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>plot.title <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                   plot.subtitle <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_text</a></span><span class="op">(</span>hjust<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>                   panel.grid.major <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>                   panel.grid.minor <span class="op">=</span> <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/element.html" class="external-link">element_blank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html" class="external-link">scale_colour_manual</a></span><span class="op">(</span>values<span class="op">=</span><span class="va">TISSUE_COLORS</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">TISSUE_COLORS</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">data</span><span class="op">[</span>,<span class="va">tissue</span><span class="op">]</span><span class="op">]</span>, </span>
<span>                                 name<span class="op">=</span><span class="st">"Tissue"</span>,</span>
<span>                                 labels<span class="op">=</span><span class="va">labels</span><span class="op">)</span> <span class="op">+</span></span>
<span>    <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_discrete.html" class="external-link">scale_x_discrete</a></span><span class="op">(</span>limits<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'control'</span>,<span class="st">'1w'</span>,<span class="st">'2w'</span>,<span class="st">'fill'</span>,<span class="st">'4w'</span>,<span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">'fill'</span>,<span class="fl">3</span><span class="op">)</span>, <span class="st">'8w'</span><span class="op">)</span>,</span>
<span>                     labels<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'0'</span>,<span class="st">'1'</span>,<span class="st">'2'</span>,<span class="st">'4'</span>,<span class="st">'8'</span><span class="op">)</span>,</span>
<span>                     breaks<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'control'</span>,<span class="st">'1w'</span>,<span class="st">'2w'</span>,<span class="st">'4w'</span>,<span class="st">'8w'</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">g</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code></pre></div>
<p><img src="key_metabolites_files/figure-html/multi-tissue-1.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-2.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-3.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-4.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-5.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-6.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-7.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-8.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-9.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-10.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-11.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-12.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-13.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-14.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-15.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-16.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-17.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-18.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-19.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-20.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-21.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-22.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-23.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-24.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-25.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-26.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-27.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-28.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-29.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-30.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-31.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-32.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-33.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-34.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-35.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-36.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-37.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-38.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-39.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-40.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-41.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-42.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-43.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-44.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-45.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-46.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-47.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-48.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-49.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-50.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-51.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-52.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-53.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-54.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-55.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-56.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-57.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-58.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-59.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-60.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-61.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-62.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-63.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-64.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-65.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-66.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-67.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-68.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-69.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-70.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-71.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-72.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-73.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-74.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-75.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-76.png" width="960" style="display: block; margin: auto;"><img src="key_metabolites_files/figure-html/multi-tissue-77.png" width="960" style="display: block; margin: auto;"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
