<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Custom pathway enrichment for graphical clusters — custom_cluster_pathway_enrichment • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Custom pathway enrichment for graphical clusters — custom_cluster_pathway_enrichment"><meta name="description" content="Wrapper for multi-tissue, multi-omic pathway enrichment of clustering or
graphical results with a user-supplied list of pathways.
Pathway enrichment is performed using a hypergeometric test separately for
each unique combination of tissue, assay/ome, and cluster."><meta property="og:description" content="Wrapper for multi-tissue, multi-omic pathway enrichment of clustering or
graphical results with a user-supplied list of pathways.
Pathway enrichment is performed using a hypergeometric test separately for
each unique combination of tissue, assay/ome, and cluster."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Custom pathway enrichment for graphical clusters</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/pathway_enrichment.R" class="external-link"><code>R/pathway_enrichment.R</code></a></small>
      <div class="d-none name"><code>custom_cluster_pathway_enrichment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Wrapper for multi-tissue, multi-omic pathway enrichment of clustering or
graphical results with a user-supplied list of pathways.
Pathway enrichment is performed using a hypergeometric test separately for
each unique combination of tissue, assay/ome, and cluster.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">custom_cluster_pathway_enrichment</span><span class="op">(</span></span>
<span>  <span class="va">cluster_res</span>,</span>
<span>  <span class="va">pathway_member_list</span>,</span>
<span>  source <span class="op">=</span> <span class="st">"custom"</span>,</span>
<span>  feature_to_gene <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/FEATURE_TO_GENE_FILT.html">FEATURE_TO_GENE_FILT</a></span>,</span>
<span>  gene_identifier_type <span class="op">=</span> <span class="st">"gene_symbol"</span>,</span>
<span>  universe <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GENE_UNIVERSES.html">GENE_UNIVERSES</a></span><span class="op">$</span><span class="va">gene_symbol</span>,</span>
<span>  add_ensembl_intersection <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  min_input_set_size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  min_pw_set_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_pw_set_size <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  adjust_p <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  num_cores <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  logfile <span class="op">=</span> <span class="st">"/dev/null"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cluster-res">cluster_res<a class="anchor" aria-label="anchor" href="#arg-cluster-res"></a></dt>
<dd><p>Either a data frame or a list of lists.
If a data frame, it needs at least two columns: "feature" and "cluster".
The "feature" column should be in the format
'<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a>;<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>;feature_ID'.
If a list of lists, each sublist must be named with the cluster name (character string),
and the values must be features in the format
'<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a>;<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>;feature_ID'.</p></dd>


<dt id="arg-pathway-member-list">pathway_member_list<a class="anchor" aria-label="anchor" href="#arg-pathway-member-list"></a></dt>
<dd><p>named list of character vectors where names are pathway names
and values are pathway members. Pathway members must match values in the
<code>gene_identifer_type</code> column of <code>feature_to_gene</code>.</p></dd>


<dt id="arg-source">source<a class="anchor" aria-label="anchor" href="#arg-source"></a></dt>
<dd><p>optional character string to define the source of <code>pathway_member_list</code></p></dd>


<dt id="arg-feature-to-gene">feature_to_gene<a class="anchor" aria-label="anchor" href="#arg-feature-to-gene"></a></dt>
<dd><p>data frame, map between <code>intersection_id_type</code> and gene symbols.
Columns must include "feature_ID", "gene_symbol", "ensembl_gene", and "kegg_id".
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/FEATURE_TO_GENE_FILT.html">MotrpacRatTraining6moData::FEATURE_TO_GENE_FILT</a> by default.</p></dd>


<dt id="arg-gene-identifier-type">gene_identifier_type<a class="anchor" aria-label="anchor" href="#arg-gene-identifier-type"></a></dt>
<dd><p>character, column in <code>feature_to_gene</code> that
matches the gene identifier type in <code>universe</code>.
"gene_symbol" by default.</p></dd>


<dt id="arg-universe">universe<a class="anchor" aria-label="anchor" href="#arg-universe"></a></dt>
<dd><p>list of lists of character vectors,
named first by assay (i.e., <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a>)
and then by tissue (i.e., <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>).
Vectors provide the full set of gene symbols associated with features tested
during differential analysis. For example, <code>universe$TRNSCRPT$LUNG</code>
should be a character vector of expressed genes in the lung, where the type
of gene identifier matches <code>gene_identifier_type</code>.
<code>[MotrpacRatTraining6moData::GENE_UNIVERSES]$gene_symbol</code> by default.</p></dd>


<dt id="arg-add-ensembl-intersection">add_ensembl_intersection<a class="anchor" aria-label="anchor" href="#arg-add-ensembl-intersection"></a></dt>
<dd><p>bool, whether to add a <code>intersection_ensembl</code>
column, which converts gene IDs in the intersection to Ensembl IDs</p></dd>


<dt id="arg-min-input-set-size">min_input_set_size<a class="anchor" aria-label="anchor" href="#arg-min-input-set-size"></a></dt>
<dd><p>integer, input must have this minimum number of
unique mappable gene IDs to attempt enrichment</p></dd>


<dt id="arg-min-pw-set-size">min_pw_set_size<a class="anchor" aria-label="anchor" href="#arg-min-pw-set-size"></a></dt>
<dd><p>integer, pathway must have at least this many members
to attempt enrichment</p></dd>


<dt id="arg-max-pw-set-size">max_pw_set_size<a class="anchor" aria-label="anchor" href="#arg-max-pw-set-size"></a></dt>
<dd><p>integer, pathway must have no more than this many members
to attempt enrichment</p></dd>


<dt id="arg-adjust-p">adjust_p<a class="anchor" aria-label="anchor" href="#arg-adjust-p"></a></dt>
<dd><p>boolean, whether to adjust nominal p-values for multiple testing (IHW by tissue)</p></dd>


<dt id="arg-num-cores">num_cores<a class="anchor" aria-label="anchor" href="#arg-num-cores"></a></dt>
<dd><p>optional integer, number of cores to register if parallel computing is desired</p></dd>


<dt id="arg-logfile">logfile<a class="anchor" aria-label="anchor" href="#arg-logfile"></a></dt>
<dd><p>optional character, path to log of failed iterations</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data frame with enrichment results, or NULL if no enrichment results were returned:</p><dl><dt><code>term_size</code></dt>
<dd><p>integer, number of genes that are annotated to the term</p></dd>

<dt><code>query_size</code></dt>
<dd><p>integer, number of genes that were included in the query</p></dd>

<dt><code>intersection_size</code></dt>
<dd><p>integer, the number of genes in the input query that are annotated to the corresponding term</p></dd>

<dt><code>term_id</code></dt>
<dd><p>character, unique term/pathway identifier</p></dd>

<dt><code>source</code></dt>
<dd><p>character, the abbreviation of the data source for the term/pathway</p></dd>

<dt><code>term_name</code></dt>
<dd><p>character, term/pathway name</p></dd>

<dt><code>effective_domain_size</code></dt>
<dd><p>integer, the total number of genes in the universe used for the hypergeometric test</p></dd>

<dt><code>intersection</code></dt>
<dd><p>character, input gene IDs that intersect with the term/pathway</p></dd>

<dt><code>computed_p_value</code></dt>
<dd><p>double, nominal hypergeometric p-value</p></dd>

<dt><code>cluster</code></dt>
<dd><p>character, cluster label</p></dd>

<dt><code>tissue</code></dt>
<dd><p>character, tissue abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a></p></dd>

<dt><code>ome</code></dt>
<dd><p>character, assay abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a></p></dd>

<dt><code>adj_p_value</code></dt>
<dd><p>double, adjusted nominal p-value
<code>computed_p_value</code> using IHW with tissue as a covariate</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="pathway_hypergeom_test.html">pathway_hypergeom_test()</a></code>, <code><a href="cluster_pathway_enrichment.html">cluster_pathway_enrichment()</a></code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Use graphical clusters as an example</span></span></span>
<span class="r-in"><span><span class="va">cluster_res</span> <span class="op">=</span> <span class="fu"><a href="extract_main_clusters.html">extract_main_clusters</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Pick a single graphical cluster</span></span></span>
<span class="r-in"><span><span class="co"># Gastrocnemius features up-regulated in both males and females at 8 weeks of training</span></span></span>
<span class="r-in"><span><span class="va">cluster_res</span> <span class="op">=</span> <span class="va">cluster_res</span><span class="op">[</span><span class="va">cluster_res</span><span class="op">$</span><span class="va">cluster</span> <span class="op">==</span> <span class="st">"SKM-GN:8w_F1_M1"</span>,<span class="op">]</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Make a toy pathway member list with human gene symbols</span></span></span>
<span class="r-in"><span><span class="va">pathways</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="st">"TCA cycle"</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">'ACO2'</span>,<span class="st">'CS'</span>,<span class="st">'FH'</span>,<span class="st">'MDH1'</span>,<span class="st">'OGDH'</span>,<span class="st">'PDHA1'</span>,<span class="st">'PDHA2'</span>,<span class="st">'SDHC'</span>,<span class="st">'SUCLG1'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert human gene symbols to rat gene symbols </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"RAT_TO_HUMAN_GENE"</span>, package <span class="op">=</span> <span class="st">"MotrpacRatTraining6moData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">pw</span> <span class="kw">in</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">pathways</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="va">newmembers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="kw">for</span> <span class="op">(</span><span class="va">m</span> <span class="kw">in</span> <span class="va">pathways</span><span class="op">[[</span><span class="va">pw</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>    <span class="co"># get rat symbol</span></span></span>
<span class="r-in"><span>    <span class="va">rat</span> <span class="op">=</span> <span class="va">RAT_TO_HUMAN_GENE</span><span class="op">$</span><span class="va">RAT_SYMBOL</span><span class="op">[</span><span class="va">RAT_TO_HUMAN_GENE</span><span class="op">$</span><span class="va">HUMAN_ORTHOLOG_SYMBOL</span> <span class="op">==</span> <span class="va">m</span><span class="op">]</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span></span>
<span class="r-in"><span>    <span class="kw">if</span><span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html" class="external-link">is.na</a></span><span class="op">(</span><span class="va">rat</span><span class="op">)</span><span class="op">)</span><span class="op">{</span></span></span>
<span class="r-in"><span>      <span class="va">newmembers</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">newmembers</span>, <span class="va">rat</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="op">}</span></span></span>
<span class="r-in"><span>  <span class="va">pathways</span><span class="op">[[</span><span class="va">pw</span><span class="op">]</span><span class="op">]</span> <span class="op">=</span> <span class="va">newmembers</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Perform pathway enrichment </span></span></span>
<span class="r-in"><span><span class="fu">custom_cluster_pathway_enrichment</span><span class="op">(</span><span class="va">cluster_res</span>, </span></span>
<span class="r-in"><span>                                  pathway_member_list <span class="op">=</span> <span class="va">pathways</span>,</span></span>
<span class="r-in"><span>                                  min_pw_set_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of cores not defined with 'num_cores' argument. Setting the number of cores to 1. Explicity define 'num_cores' to take advantage of parallelization. If you aren't sure how many cores are available to you, try 'length(parallel::mcaffinity()).'</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Running enrichments for 6 gene sets on 1 core(s). This may take a while...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 6 out of 38 identifiers in SKM-GN:8w_F1_M1 ATAC SKM-GN are not in the current universe. Removing these features.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Edn2"           "AABR07030921.1" "U6"             "AABR07004761.1"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "AABR07062157.1" "Y_RNA"         </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> 2 out of 5 identifiers in SKM-GN:8w_F1_M1 METHYL SKM-GN are not in the current universe. Removing these features.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Mir196a"        "AABR07002473.1"</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   term_size query_size intersection_size   term_id source term_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1         6        121                 2 TCA_cycle custom TCA cycle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2         9        339                 6 TCA_cycle custom TCA cycle</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   effective_domain_size                 intersection computed_p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  3920                      Cs,Mdh1     1.306742e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                  5756 Cs,Fh,Mdh1,Ogdh,Pdha1,Suclg1     2.885974e-06</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                                                intersection_ensembl</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                                                                             ENSRNOG00000008103,ENSRNOG00000023520</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 ENSRNOG00000003653,ENSRNOG00000008103,ENSRNOG00000025383,ENSRNOG00000005587,ENSRNOG00000023520,ENSRNOG00000005130</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           cluster tissue     ome  adj_p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 SKM-GN:8w_F1_M1 SKM-GN PHOSPHO 1.306742e-02</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 SKM-GN:8w_F1_M1 SKM-GN    PROT 5.771947e-06</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

