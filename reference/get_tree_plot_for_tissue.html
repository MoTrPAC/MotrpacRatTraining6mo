<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Graph representation of feature trajectories — get_tree_plot_for_tissue • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Graph representation of feature trajectories — get_tree_plot_for_tissue"><meta name="description" content="The main function for obtaining a graphical (tree) representation of the differential
analysis results."><meta property="og:description" content="The main function for obtaining a graphical (tree) representation of the differential
analysis results."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Graph representation of feature trajectories</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/bayesian_graphical_clustering.R" class="external-link"><code>R/bayesian_graphical_clustering.R</code></a></small>
      <div class="d-none name"><code>get_tree_plot_for_tissue.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The main function for obtaining a graphical (tree) representation of the differential
analysis results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_tree_plot_for_tissue</span><span class="op">(</span></span>
<span>  <span class="va">tissues</span>,</span>
<span>  omes <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  node_sets <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GRAPH_COMPONENTS.html">GRAPH_COMPONENTS</a></span><span class="op">$</span><span class="va">node_sets</span>,</span>
<span>  edge_sets <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GRAPH_COMPONENTS.html">GRAPH_COMPONENTS</a></span><span class="op">$</span><span class="va">edge_sets</span>,</span>
<span>  min_size <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  parallel_edges_by_ome <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  parallel_edges_by_tissue <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  edge_width_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">10</span><span class="op">)</span>,</span>
<span>  edge_alpha_range <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span><span class="op">)</span>,</span>
<span>  color_nodes_by_states <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max_trajectories <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  highlight_subset <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  curvature <span class="op">=</span> <span class="fl">0.1</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tissues">tissues<a class="anchor" aria-label="anchor" href="#arg-tissues"></a></dt>
<dd><p>A character vector where values are in <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>.
The set of tissues to take for the analysis. If NULL take all.</p></dd>


<dt id="arg-omes">omes<a class="anchor" aria-label="anchor" href="#arg-omes"></a></dt>
<dd><p>A character vector where values are in <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a>.
The set of omes to take for the analysis. If NULL take all.</p></dd>


<dt id="arg-node-sets">node_sets<a class="anchor" aria-label="anchor" href="#arg-node-sets"></a></dt>
<dd><p>A named list with the node (state) sets of analytes/features, see details for analyte name convention.
<code><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GRAPH_COMPONENTS.html">GRAPH_COMPONENTS</a>$node_sets</code> by default.</p></dd>


<dt id="arg-edge-sets">edge_sets<a class="anchor" aria-label="anchor" href="#arg-edge-sets"></a></dt>
<dd><p>A named list with the edge (state) sets of analytes/features, see details for analyte name convention.
<code><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GRAPH_COMPONENTS.html">GRAPH_COMPONENTS</a>$edge_sets</code> by default.</p></dd>


<dt id="arg-min-size">min_size<a class="anchor" aria-label="anchor" href="#arg-min-size"></a></dt>
<dd><p>A numeric. The threshold on the set sizes to be considered.</p></dd>


<dt id="arg-parallel-edges-by-ome">parallel_edges_by_ome<a class="anchor" aria-label="anchor" href="#arg-parallel-edges-by-ome"></a></dt>
<dd><p>A logical. TRUE means that we want to added parallel edges for the different omes.</p></dd>


<dt id="arg-parallel-edges-by-tissue">parallel_edges_by_tissue<a class="anchor" aria-label="anchor" href="#arg-parallel-edges-by-tissue"></a></dt>
<dd><p>A logical. TRUE means that we want to added parallel edges for the different tissues.</p></dd>


<dt id="arg-edge-width-range">edge_width_range<a class="anchor" aria-label="anchor" href="#arg-edge-width-range"></a></dt>
<dd><p>A numeric vector of size 2, a parameter for ggraph</p></dd>


<dt id="arg-edge-alpha-range">edge_alpha_range<a class="anchor" aria-label="anchor" href="#arg-edge-alpha-range"></a></dt>
<dd><p>A numeric vector of size 2, a parameter for ggraph</p></dd>


<dt id="arg-color-nodes-by-states">color_nodes_by_states<a class="anchor" aria-label="anchor" href="#arg-color-nodes-by-states"></a></dt>
<dd><p>A logical. If TRUE, nodes are colored by states. Red for up-reg, blue for down-reg, green for a discrepancy between the sexes.</p></dd>


<dt id="arg-max-trajectories">max_trajectories<a class="anchor" aria-label="anchor" href="#arg-max-trajectories"></a></dt>
<dd><p>A numeric or NULL. If not NULL then it specifies the number of pathways to keep when looking into the edge sets after filtering by omes and tissues. If  parallel_edges_by_tissue = TRUE then take the top trajectories in each tissue.</p></dd>


<dt id="arg-highlight-subset">highlight_subset<a class="anchor" aria-label="anchor" href="#arg-highlight-subset"></a></dt>
<dd><p>A character string or NULL. If not NULL then it specifies the name of a node, edge, or path to highlight in the tree.</p></dd>


<dt id="arg-curvature">curvature<a class="anchor" aria-label="anchor" href="#arg-curvature"></a></dt>
<dd><p>A number between 0 and 1, where larger values yield more curved edges.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a graph object</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The function filters the input set to include analytes from the given tissues and omes (if tissues/omes are not null).
If parallel edges are requested then the relevant edge sizes are computed internally and are used within ggraph for the output plot.
Analyte names are in the <code><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">ASSAY_ABBREV</a>;<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">TISSUE_ABBREV</a>;[feature_ID]</code> format.
Node set names are are in the <code>[{1,2,4,8}]w_F[{-1,0,1}]_M[{-1,0,1}]</code> format for example: <code>1w_F-1_M0</code>.
Edge set names are in the <code>[node_a]---[node_b]</code> format, e.g., <code>4w_F0_M0---8w_F0_M1</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="bayesian_graphical_clustering.html">bayesian_graphical_clustering()</a></code> for more details about the graphical analysis.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co">### Example 1: redo the analysis using the rat data differential analysis results (z-scores)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">REPFDR_INPUTS</span>, package<span class="op">=</span><span class="st">"MotrpacRatTraining6moData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zscores</span> <span class="op">=</span> <span class="va">REPFDR_INPUTS</span><span class="op">$</span><span class="va">zs_smoothed</span></span></span>
<span class="r-in"><span><span class="va">rat_data_clustering_sol</span> <span class="op">=</span> <span class="fu"><a href="bayesian_graphical_clustering.html">bayesian_graphical_clustering</a></span><span class="op">(</span><span class="va">zscores</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># extract the largest trajectories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_trajectory_sizes_from_edge_sets.html">get_trajectory_sizes_from_edge_sets</a></span><span class="op">(</span><span class="va">rat_data_clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>,min_size <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot the top trajectories of the muscle tissues, color edges by tissue</span></span></span>
<span class="r-in"><span><span class="fu">get_tree_plot_for_tissue</span><span class="op">(</span>tissues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SKM-GN"</span>,<span class="st">"HEART"</span>,<span class="st">"SKM-VL"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>                         omes <span class="op">=</span> <span class="st">"TRNSCRPT"</span>,</span></span>
<span class="r-in"><span>                         node_sets <span class="op">=</span> <span class="va">rat_data_clustering_sol</span><span class="op">$</span><span class="va">node_sets</span>, </span></span>
<span class="r-in"><span>                         edge_sets <span class="op">=</span> <span class="va">rat_data_clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>, </span></span>
<span class="r-in"><span>                         min_size <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                         parallel_edges_by_tissue <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                         max_trajectories <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 2: load the graphical solutions from MotrpacRatTraining6moData </span></span></span>
<span class="r-in"><span><span class="co">### and plot without rerunning the algorithm</span></span></span>
<span class="r-in"><span><span class="fu">get_tree_plot_for_tissue</span><span class="op">(</span></span></span>
<span class="r-in"><span>  tissues<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SKM-GN"</span>,<span class="st">"HEART"</span>,<span class="st">"SKM-VL"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  omes<span class="op">=</span><span class="st">"TRNSCRPT"</span>,</span></span>
<span class="r-in"><span>  min_size <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>  parallel_edges_by_tissue <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>  max_trajectories <span class="op">=</span> <span class="fl">3</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Using <span style="color: #0000BB;">"sugiyama"</span> as default layout</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>Ignoring `graph` as layout is already calculated</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Pass the calculated layout to the `graph` argument to silence this warning</span>
<span class="r-plt img"><img src="get_tree_plot_for_tissue-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

