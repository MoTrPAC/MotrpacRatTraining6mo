<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Call PCA outliers — call_pca_outliers • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Call PCA outliers — call_pca_outliers"><meta name="description" content="Identify samples that fall outside of the specified range for principal
components that explain some minimum variance."><meta property="og:description" content="Identify samples that fall outside of the specified range for principal
components that explain some minimum variance."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Call PCA outliers</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/call_outliers.R" class="external-link"><code>R/call_outliers.R</code></a></small>
      <div class="d-none name"><code>call_pca_outliers.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Identify samples that fall outside of the specified range for principal
components that explain some minimum variance.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">call_pca_outliers</span><span class="op">(</span></span>
<span>  <span class="va">norm</span>,</span>
<span>  <span class="va">min_pc_ve</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  plot <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  iqr_coef <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  M <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-norm">norm<a class="anchor" aria-label="anchor" href="#arg-norm"></a></dt>
<dd><p>feature by sample data frame of normalized data</p></dd>


<dt id="arg-min-pc-ve">min_pc_ve<a class="anchor" aria-label="anchor" href="#arg-min-pc-ve"></a></dt>
<dd><p>numeric, minimum percent variance explained by a PC to check it for outliers</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>bool, whether to scale input data before PCA. <code>TRUE</code> by default.</p></dd>


<dt id="arg-plot">plot<a class="anchor" aria-label="anchor" href="#arg-plot"></a></dt>
<dd><p>bool, whether to print PC plots before and after removing outliers. <code>TRUE</code> by default.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>bool, whether to print descriptive strings. <code>TRUE</code> by default.</p></dd>


<dt id="arg-iqr-coef">iqr_coef<a class="anchor" aria-label="anchor" href="#arg-iqr-coef"></a></dt>
<dd><p>numeric, flag PC outliers if they are outside of IQR * <code>iqr_coef</code></p></dd>


<dt id="arg-m">M<a class="anchor" aria-label="anchor" href="#arg-m"></a></dt>
<dd><p>integer, select M most variable features</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>character, substring to include in PC plot titles</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>named list of four items:</p><dl><dt><code>pca_outliers</code></dt>
<dd><p>character vector of viallabels identified as outliers</p></dd>

<dt><code>prcomp_obj</code></dt>
<dd><p>result returned by <code><a href="https://rdrr.io/r/stats/prcomp.html" class="external-link">prcomp()</a></code> from PCA of normalized data without outliers removed</p></dd>

<dt><code>num_pcs</code></dt>
<dd><p>integer, number of PCs checked for outliers</p></dd>

<dt><code>pc_outliers_report</code></dt>
<dd><p>matrix of results with one row per outlier</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">bat_rna_data</span> <span class="op">=</span> <span class="fu"><a href="transcript_prep_data.html">transcript_prep_data</a></span><span class="op">(</span><span class="st">"BAT"</span>, covariates <span class="op">=</span> <span class="cn">NULL</span>, outliers <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_BAT_RAW_COUNTS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_BAT_NORM_DATA</span>
<span class="r-in"><span><span class="va">bat_rna_outliers</span> <span class="op">=</span> <span class="fu">call_pca_outliers</span><span class="op">(</span><span class="va">bat_rna_data</span><span class="op">$</span><span class="va">norm_data</span>, </span></span>
<span class="r-in"><span>                                     min_pc_ve<span class="op">=</span><span class="fl">0.05</span>, </span></span>
<span class="r-in"><span>                                     iqr_coef<span class="op">=</span><span class="fl">5</span>, </span></span>
<span class="r-in"><span>                                     M<span class="op">=</span><span class="fl">1000</span>, </span></span>
<span class="r-in"><span>                                     title<span class="op">=</span><span class="st">"Brown Adipose"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     PC1     PC2     PC3     PC4     PC5     PC6     PC7     PC8     PC9    PC10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 0.17851 0.12381 0.09078 0.04275 0.02831 0.02600 0.02306 0.02091 0.02076 0.01946 </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The first 3 PCs were selected to identify outliers.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PC outliers:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      PC    viallabel     PC value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] "PC3" "90266016902" "23.213"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] "PC3" "90416016902" "54.24" </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting PCs with outliers flagged...</span>
<span class="r-plt img"><img src="call_pca_outliers-1.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="call_pca_outliers-2.png" alt="" width="700" height="433"></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Plotting PCs with outliers removed...</span>
<span class="r-plt img"><img src="call_pca_outliers-3.png" alt="" width="700" height="433"></span>
<span class="r-plt img"><img src="call_pca_outliers-4.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

