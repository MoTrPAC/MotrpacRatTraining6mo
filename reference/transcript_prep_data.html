<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Preprocess RNA-seq data — transcript_prep_data • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Preprocess RNA-seq data — transcript_prep_data"><meta name="description" content="Collect filtered raw counts, normalized sample-level data, phenotypic data, RNA-seq metadata,
covariates, and outliers associated with a given tissue."><meta property="og:description" content="Collect filtered raw counts, normalized sample-level data, phenotypic data, RNA-seq metadata,
covariates, and outliers associated with a given tissue."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Preprocess RNA-seq data</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/fetch_prep_data.R" class="external-link"><code>R/fetch_prep_data.R</code></a></small>
      <div class="d-none name"><code>transcript_prep_data.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Collect filtered raw counts, normalized sample-level data, phenotypic data, RNA-seq metadata,
covariates, and outliers associated with a given tissue.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">transcript_prep_data</span><span class="op">(</span></span>
<span>  <span class="va">tissue</span>,</span>
<span>  sex <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pct_globin"</span>, <span class="st">"RIN"</span>, <span class="st">"pct_umi_dup"</span>, <span class="st">"median_5_3_bias"</span><span class="op">)</span>,</span>
<span>  outliers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/OUTLIERS.html">OUTLIERS</a></span><span class="op">$</span><span class="va">viallabel</span><span class="op">)</span>,</span>
<span>  adjust_covariates <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  center_scale <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tissue">tissue<a class="anchor" aria-label="anchor" href="#arg-tissue"></a></dt>
<dd><p>character, tissue abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a></p></dd>


<dt id="arg-sex">sex<a class="anchor" aria-label="anchor" href="#arg-sex"></a></dt>
<dd><p>character, one of 'male' or 'female'</p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>character vector of covariates that correspond to column names of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_META.html">MotrpacRatTraining6moData::TRNSCRPT_META</a>.
Defaults to covariates that were used for the manuscript.</p></dd>


<dt id="arg-outliers">outliers<a class="anchor" aria-label="anchor" href="#arg-outliers"></a></dt>
<dd><p>vector of viallabels to exclude from the returned data. Defaults
to <code>[MotrpacRatTraining6moData::OUTLIERS]$viallabel</code></p></dd>


<dt id="arg-adjust-covariates">adjust_covariates<a class="anchor" aria-label="anchor" href="#arg-adjust-covariates"></a></dt>
<dd><p>boolean, whether to adjust covariates using <code><a href="fix_covariates.html">fix_covariates()</a></code>.
Only applies if <code>covariates</code> is not NULL.</p></dd>


<dt id="arg-center-scale">center_scale<a class="anchor" aria-label="anchor" href="#arg-center-scale"></a></dt>
<dd><p>boolean, whether to center and scale continuous covariates within <code><a href="fix_covariates.html">fix_covariates()</a></code>.
Only applies if <code>adjust_covariates</code> is also TRUE.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>named list of five items:</p><dl><dt><code>metadata</code></dt>
<dd><p>data frame of combined <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/PHENO.html">MotrpacRatTraining6moData::PHENO</a> and <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_META.html">MotrpacRatTraining6moData::TRNSCRPT_META</a>, filtered to samples in <code>tissue</code>.
If <code>adjust_covariates = TRUE</code>, missing values in <code>covariates</code> are imputed.
If also <code>center_scale = TRUE</code>, continuous variables named by <code>covariates</code> are centered and scaled.</p></dd>

<dt><code>covariates</code></dt>
<dd><p>character vector of covariates to adjust for during differential analysis. For all tissues except VENACV,
this vector is a (sub)set of the input list of covariates. Covariates are removed from this vector if there are too
many missing values or if all values are constant. See <code><a href="fix_covariates.html">fix_covariates()</a></code> for more details.
If <code>tissue = "VENACV"</code>, the Ensembl ID for Ucp1 is also added as a covariate.</p></dd>

<dt><code>counts</code></dt>
<dd><p>data frame of raw counts with Ensembl IDs (which are also TRNSCRPT <code>feature_ID</code>s)
as row names and vial labels as column names. See <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_RAW_COUNTS.html">MotrpacRatTraining6moData::TRNSCRPT_RAW_COUNTS</a> for details.</p></dd>

<dt><code>norm_data</code></dt>
<dd><p>data frame of TMM-normalized data with Ensembl IDs (which are also TRNSCRPT
<code>feature_ID</code>s) as row names and vial labels as column names. See <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_NORM_DATA.html">MotrpacRatTraining6moData::TRNSCRPT_NORM_DATA</a> for details.</p></dd>

<dt><code>outliers</code></dt>
<dd><p>subset of <code>outliers</code> in input removed from the data</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/OUTLIERS.html">MotrpacRatTraining6moData::OUTLIERS</a>,
<code><a href="fix_covariates.html">fix_covariates()</a></code>,
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/PHENO.html">MotrpacRatTraining6moData::PHENO</a>,
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_META.html">MotrpacRatTraining6moData::TRNSCRPT_META</a>,
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_RAW_COUNTS.html">MotrpacRatTraining6moData::TRNSCRPT_RAW_COUNTS</a>,
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_NORM_DATA.html">MotrpacRatTraining6moData::TRNSCRPT_NORM_DATA</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Process gastrocnemius RNA-seq data with default parameters, i.e., return data from both </span></span></span>
<span class="r-in"><span><span class="co"># sexes, remove established outliers, impute missing values in default covariates </span></span></span>
<span class="r-in"><span><span class="va">gastroc_data1</span> <span class="op">=</span> <span class="fu">transcript_prep_data</span><span class="op">(</span><span class="st">"SKM-GN"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_RAW_COUNTS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_NORM_DATA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above but do not remove outliers if they exist </span></span></span>
<span class="r-in"><span><span class="va">gastroc_data2</span> <span class="op">=</span> <span class="fu">transcript_prep_data</span><span class="op">(</span><span class="st">"SKM-GN"</span>, outliers <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_RAW_COUNTS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_NORM_DATA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above but do not adjust existing variables in the metadata  </span></span></span>
<span class="r-in"><span><span class="va">gastroc_data3</span> <span class="op">=</span> <span class="fu">transcript_prep_data</span><span class="op">(</span><span class="st">"SKM-GN"</span>, covariates <span class="op">=</span> <span class="cn">NULL</span>, outliers <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_RAW_COUNTS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_NORM_DATA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above but only return data from male samples</span></span></span>
<span class="r-in"><span><span class="va">gastroc_data4</span> <span class="op">=</span> <span class="fu">transcript_prep_data</span><span class="op">(</span><span class="st">"SKM-GN"</span>, covariates <span class="op">=</span> <span class="cn">NULL</span>, outliers <span class="op">=</span> <span class="cn">NULL</span>, sex <span class="op">=</span> <span class="st">"male"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_RAW_COUNTS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_NORM_DATA</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as gastroc_data2 but also center and scale default continuous covariates </span></span></span>
<span class="r-in"><span><span class="co"># in the returned metadata, which is also done within [run_deseq()] </span></span></span>
<span class="r-in"><span><span class="co"># (called by [transcript_timewise_dea()]) </span></span></span>
<span class="r-in"><span><span class="va">gastroc_data4</span> <span class="op">=</span> <span class="fu">transcript_prep_data</span><span class="op">(</span><span class="st">"SKM-GN"</span>, outliers <span class="op">=</span> <span class="cn">NULL</span>, center_scale <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_RAW_COUNTS</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_NORM_DATA</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

