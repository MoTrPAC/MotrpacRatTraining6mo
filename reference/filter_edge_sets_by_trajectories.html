<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Keep the edges of the top trajectories of an edge set of a graphical solution."><title>Filter edge sets to largest trajectories — filter_edge_sets_by_trajectories • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter edge sets to largest trajectories — filter_edge_sets_by_trajectories"><meta property="og:description" content="Keep the edges of the top trajectories of an edge set of a graphical solution."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.5.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Filter edge sets to largest trajectories</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/HEAD/R/bayesian_graphical_clustering.R" class="external-link"><code>R/bayesian_graphical_clustering.R</code></a></small>
      <div class="d-none name"><code>filter_edge_sets_by_trajectories.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Keep the edges of the top trajectories of an edge set of a graphical solution.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">filter_edge_sets_by_trajectories</span><span class="op">(</span></span>
<span>  edge_sets <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GRAPH_COMPONENTS.html">GRAPH_COMPONENTS</a></span><span class="op">$</span><span class="va">edge_sets</span>,</span>
<span>  topk <span class="op">=</span> <span class="fl">5</span>,</span>
<span>  min_path_size <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>edge_sets</dt>
<dd><p>A named list of string vectors. The name of an edge is <code>node_id---node_id</code>
edges with no analytes have a NULL set (a set of size zero, but are still represented),
node ids are <code>[timepoints]_F[x]_M[y]</code> where <code>x</code> and <code>y</code> represent the up/down state in each sex.
<code><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GRAPH_COMPONENTS.html">GRAPH_COMPONENTS</a>$edge_sets</code> by default.</p></dd>


<dt>topk</dt>
<dd><p>A number. The maximal number of full trajectories to include in the new solution.</p></dd>


<dt>min_path_size</dt>
<dd><p>An integer specifying the minimal path size to be considered.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A named list of edge sets. All possible edges in our 9 x 4 grid will appear in the solution.
Edges that are removed will have no features/analytes in their entry.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">### Example 1: Simulate data with a single cluster</span></span></span>
<span class="r-in"><span><span class="va">zcolnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"female"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1w"</span>,<span class="st">"2w"</span>,<span class="st">"4w"</span>,<span class="st">"8w"</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"male"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1w"</span>,<span class="st">"2w"</span>,<span class="st">"4w"</span>,<span class="st">"8w"</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zscores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80000</span><span class="op">)</span>,ncol<span class="op">=</span><span class="fl">8</span>,dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>,<span class="va">zcolnames</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># now add a cluster with a strong signal and rerun</span></span></span>
<span class="r-in"><span><span class="va">zscores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="va">zscores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="fl">5</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># run the clustering solution wrapper</span></span></span>
<span class="r-in"><span><span class="va">clustering_sol</span> <span class="op">=</span> <span class="fu"><a href="bayesian_graphical_clustering.html">bayesian_graphical_clustering</a></span><span class="op">(</span><span class="va">zscores</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract the top full trajectories in the data</span></span></span>
<span class="r-in"><span><span class="co"># these should be the clusters with at least 10 features</span></span></span>
<span class="r-in"><span><span class="va">min_cluster_size</span><span class="op">=</span><span class="fl">10</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_trajectory_sizes_from_edge_sets.html">get_trajectory_sizes_from_edge_sets</a></span><span class="op">(</span><span class="va">clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>, min_size <span class="op">=</span> <span class="va">min_cluster_size</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract the edges of the top two full trjectories</span></span></span>
<span class="r-in"><span><span class="co"># this step "cleans" the edge sets by removing edges of trajectories with very few features</span></span></span>
<span class="r-in"><span><span class="va">top2traj_edge_sets</span> <span class="op">=</span> <span class="fu">filter_edge_sets_by_trajectories</span><span class="op">(</span><span class="va">clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>,</span></span>
<span class="r-in"><span>                                                      topk <span class="op">=</span> <span class="fl">2</span>,</span></span>
<span class="r-in"><span>                                                      min_path_size <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># examine the new edge set sizes, excluded edges should have zero size</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">top2traj_edge_sets</span>,<span class="va">length</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># for comparison examine the edge sets of the Bayesian clustering solution:</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>,<span class="va">length</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">### Example 2: Use published data</span></span></span>
<span class="r-in"><span><span class="co"># Get edges corresponding to 5 largest trajectories in the liver</span></span></span>
<span class="r-in"><span><span class="va">tissue_edge_sets</span> <span class="op">=</span> <span class="fu"><a href="limit_sets_by_regex.html">limit_sets_by_regex</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GRAPH_COMPONENTS.html">GRAPH_COMPONENTS</a></span><span class="op">$</span><span class="va">edge_sets</span>,</span></span>
<span class="r-in"><span>                                       <span class="st">"LIVER"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">filter_edge_sets_by_trajectories</span><span class="op">(</span><span class="va">tissue_edge_sets</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="va">res</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, <span class="va">head</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F-1_M-1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> character(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F-1_M0`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> character(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F-1_M1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> character(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F0_M-1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> character(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F0_M0`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ACETYL;LIVER;NP_001004250.1_K85k"  "ACETYL;LIVER;NP_001005875.1_K52k" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "ACETYL;LIVER;NP_001006996.1_K136k" "ACETYL;LIVER;NP_001007667.1_K213k"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "ACETYL;LIVER;NP_001007804.1_K126k" "ACETYL;LIVER;NP_001009600.1_K134k"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F0_M1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ACETYL;LIVER;AP_004896.1_K54k"     "ACETYL;LIVER;NP_001004085.1_K395k"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "ACETYL;LIVER;NP_001004258.1_K350k" "ACETYL;LIVER;NP_001005550.1_K311k"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "ACETYL;LIVER;NP_001006967.1_K158k" "ACETYL;LIVER;NP_001006971.1_K158k"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F1_M-1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> character(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F1_M0`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> character(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`0w---1w_F1_M1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ACETYL;LIVER;NP_001013175.1_K397k" "ACETYL;LIVER;NP_001014181.2_K32k" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "ACETYL;LIVER;NP_001094009.1_K125k" "ACETYL;LIVER;NP_001099389.1_K85k" </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "ACETYL;LIVER;NP_001101226.1_K384k" "ACETYL;LIVER;NP_001101972.2_K531k"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $`1w_F-1_M-1---2w_F-1_M-1`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> character(0)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

