<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Plot feature trajectories — plot_feature_trajectories • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Plot feature trajectories — plot_feature_trajectories"><meta name="description" content="Plot group means of a set of features from normalized sample-level data."><meta property="og:description" content="Plot group means of a set of features from normalized sample-level data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Plot feature trajectories</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/plot_sample_data.R" class="external-link"><code>R/plot_sample_data.R</code></a></small>
      <div class="d-none name"><code>plot_feature_trajectories.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Plot group means of a set of features from normalized sample-level data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">plot_feature_trajectories</span><span class="op">(</span></span>
<span>  <span class="va">features</span>,</span>
<span>  training_regulated_only <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  exclude_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  center <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  scale <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  title <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  return_data <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  scratchdir <span class="op">=</span> <span class="st">"."</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-features">features<a class="anchor" aria-label="anchor" href="#arg-features"></a></dt>
<dd><p>character vector of features to plot in the format
'<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a>;<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>;feature_ID'</p></dd>


<dt id="arg-training-regulated-only">training_regulated_only<a class="anchor" aria-label="anchor" href="#arg-training-regulated-only"></a></dt>
<dd><p>bool, whether all input features are training-regulated at 5% FDR.
<code>FALSE</code> by default. If <code>TRUE</code>, data is loaded from
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRAINING_REGULATED_NORM_DATA.html">MotrpacRatTraining6moData::TRAINING_REGULATED_NORM_DATA</a> instead of with <code><a href="load_sample_data.html">load_sample_data()</a></code>,
which dramatically improves performance.</p></dd>


<dt id="arg-exclude-outliers">exclude_outliers<a class="anchor" aria-label="anchor" href="#arg-exclude-outliers"></a></dt>
<dd><p>bool, whether to remove sample outliers specified by <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/OUTLIERS.html">MotrpacRatTraining6moData::OUTLIERS</a>.
<code>TRUE</code> by default.</p></dd>


<dt id="arg-center">center<a class="anchor" aria-label="anchor" href="#arg-center"></a></dt>
<dd><p>bool, whether to center the trajectories. <code>TRUE</code> by default.</p></dd>


<dt id="arg-scale">scale<a class="anchor" aria-label="anchor" href="#arg-scale"></a></dt>
<dd><p>bool, whether to scale the trajectories. <code>TRUE</code> by default.</p></dd>


<dt id="arg-title">title<a class="anchor" aria-label="anchor" href="#arg-title"></a></dt>
<dd><p>optional character, plot title</p></dd>


<dt id="arg-return-data">return_data<a class="anchor" aria-label="anchor" href="#arg-return-data"></a></dt>
<dd><p>bool, whether to return the normalized sample-level data
corresponding to <code>features</code> instead of a plot. <code>FALSE</code> by default.</p></dd>


<dt id="arg-scratchdir">scratchdir<a class="anchor" aria-label="anchor" href="#arg-scratchdir"></a></dt>
<dd><p>character, local directory in which to download data from the web.
Current working directory by default. Only relevant if <code>features</code> includes ATAC or METHYL features.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a <code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot2::ggplot()</a></code> object if <code>return_data=FALSE</code> or a data frame otherwise</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that while features in the format
'<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a>;<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>;feature_ID'
are only given for training-regulated features in the data objects provided by
<code>MotrpacRatTraining6moData</code>, one could specify non-training-regulated features by
concatenating <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a>, <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>,
and <code>feature_ID</code> for features of interest (semi-colon-separated).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Pick largest cluster in gastrocnemius </span></span></span>
<span class="r-in"><span><span class="va">clust</span> <span class="op">=</span> <span class="fu"><a href="extract_tissue_sets.html">extract_tissue_sets</a></span><span class="op">(</span><span class="st">"SKM-GN"</span>, k<span class="op">=</span><span class="fl">1</span>, add_week8<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Extract features </span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">clust</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "8w_F1_M1"                              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2] "4w_F1_M1---8w_F1_M1"                   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "1w_F1_M1-&gt;2w_F1_M1-&gt;4w_F1_M1-&gt;8w_F1_M1"</span>
<span class="r-in"><span><span class="va">features</span> <span class="op">=</span> <span class="va">clust</span><span class="op">[[</span><span class="st">"1w_F1_M1-&gt;2w_F1_M1-&gt;4w_F1_M1-&gt;8w_F1_M1"</span><span class="op">]</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="fu">plot_feature_trajectories</span><span class="op">(</span><span class="va">features</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_feature_trajectories-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Since we're only considering training-regulated features in this example,</span></span></span>
<span class="r-in"><span><span class="co"># set training_regulated_only to TRUE to make it slightly faster </span></span></span>
<span class="r-in"><span><span class="fu">plot_feature_trajectories</span><span class="op">(</span><span class="va">features</span>, training_regulated_only<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="plot_feature_trajectories-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Plot a mix of training-regulated and non-training-regulated features</span></span></span>
<span class="r-in"><span><span class="co"># Note this takes longer because the original datasets are downloaded </span></span></span>
<span class="r-in"><span><span class="va">features</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">features</span>, <span class="st">"TRNSCRPT;SKM-GN;ENSRNOG00000000008"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">plot_feature_trajectories</span><span class="op">(</span><span class="va">features</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Identifying data sets...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Compiling sample-level data...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ATAC_SKMGN_NORM_DATA_05FDR</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> METAB SKM-GN normalized data from METAB_NORM_DATA_FLAT</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PHOSPHO_SKMGN_NORM_DATA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PROT_SKMGN_NORM_DATA</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_SKMGN_NORM_DATA</span>
<span class="r-plt img"><img src="plot_feature_trajectories-3.png" alt="" width="700" height="433"></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

