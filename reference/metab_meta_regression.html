<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Perform meta-regression for repeated measurements.
Return merged timewise and training differential analysis summary statistics,
where results for features with multiple measurements are replaced with the
meta-regression results when appropriate. This method was used to generate the
MotrpacRatTraining6moData::METAB_DA_METAREG differential analysis results,
which are the version of results used in the manuscript analyses."><title>Metabolomics meta-regression — metab_meta_regression • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Metabolomics meta-regression — metab_meta_regression"><meta property="og:description" content="Perform meta-regression for repeated measurements.
Return merged timewise and training differential analysis summary statistics,
where results for features with multiple measurements are replaced with the
meta-regression results when appropriate. This method was used to generate the
MotrpacRatTraining6moData::METAB_DA_METAREG differential analysis results,
which are the version of results used in the manuscript analyses."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.4.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Metabolomics meta-regression</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/HEAD/R/metabolomics_meta_regression.R" class="external-link"><code>R/metabolomics_meta_regression.R</code></a></small>
      <div class="d-none name"><code>metab_meta_regression.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform meta-regression for repeated measurements.
Return merged timewise and training differential analysis summary statistics,
where results for features with multiple measurements are replaced with the
meta-regression results when appropriate. This method was used to generate the
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/METAB_DA_METAREG.html">MotrpacRatTraining6moData::METAB_DA_METAREG</a> differential analysis results,
which are the version of results used in the manuscript analyses.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">metab_meta_regression</span><span class="op">(</span></span>
<span>  <span class="va">tissue</span>,</span>
<span>  timewise_input <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  training_input <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  het_p_threshold <span class="op">=</span> <span class="fl">0.001</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tissue</dt>
<dd><p>character, tissue abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a></p></dd>


<dt>timewise_input</dt>
<dd><p>r data frame, custom input. To see the expected format, look at
a table returned by <code><a href="load_metab_da.html">load_metab_da()</a></code> with <code>type="timewise"</code>.</p></dd>


<dt>training_input</dt>
<dd><p>r data frame, custom input. To see the expected format, look at
a table returned by <code><a href="load_metab_da.html">load_metab_da()</a></code> with <code>type="training"</code>.</p></dd>


<dt>het_p_threshold</dt>
<dd><p>numeric, meta-regression cases with a heterogeneity p-value
below this are considered to have high heterogeneity. Default: 0.001</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>named list where <code>meta_reg_timewise_dea</code> is a data frame with
the adjusted timewise results, <code>training_meta_regression</code> is a data frame with the adjusted training
results, <code>meta_regression_results</code> is a named list with meta-regression
results per redundant metabolite, <code>meta_regression_models</code> is a table of the number of each
type of model used for meta-regression, and <code>metabolite_categories</code> is a named list
of the RefMet IDs of metabolites corresponding to each category described in the details.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>We try multiple models per repeated analyte:</p><ul><li><p>Model 1:Two random effects factors if <code>platform</code> and <code>is_targeted</code> are not redundant. Default optimization.</p></li>
<li><p>Model 2:Two random effects factors if <code>platform</code> and <code>is_targeted</code> are not redundant with alternative optimization.</p></li>
<li><p>Model 3:<code>platform</code> and <code>is_targeted</code> are redundant. Use a single RE factor with default optimization.
Also, use this if <code>QMp</code> is NA, which is an indication of over-parameterization of the model.</p></li>
<li><p>Model 4:<code>platform</code> and <code>is_targeted</code> are redundant. Use a single RE factor with alternative optimization.</p></li>
<li><p>Model 5:If all previous analyses failed, use a simple fixed-effects approach.</p></li>
</ul><p>After performing meta-regression, we define four categories of metabolites:</p><ol><li><p>measured once</p></li>
<li><p>measured multiple times, high heterogeneity, has a targeted platform</p></li>
<li><p>measured multiple times, high heterogeneity, no targeted platform</p></li>
<li><p>measured multiple times, low heterogeneity</p></li>
</ol><p>For categories 1 and 3 we keep the results as is.
For category 2 we take the targeted data only.
Finally, for category 4 we take the meta-regression results.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="load_metab_da.html">load_metab_da()</a></code>, <code><a href="metabolite_meta_regression.html">metabolite_meta_regression()</a></code>, <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/METAB_DA_METAREG.html">MotrpacRatTraining6moData::METAB_DA_METAREG</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Perform meta-regression for gastrocnemius</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">metab_meta_regression</span><span class="op">(</span><span class="st">"SKM-GN"</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>SKM-GN differential analysis results have ref standard results. Excluding them from meta-analysis.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Performing meta-regression for 117 redundant metabolites in SKM-GN...</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Done.</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Number of models that were fit for SKM-GN:</span>
<span class="r-plt img"><img src="metab_meta_regression-1.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                                 metareg_nplatform</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> metareg_calls                                                     2  3  4  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   list(~analysis_group | platform, ~analysis_group | istargeted)  0 22  8  5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   x_subset                                                        2  5  1  0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   FE                                                             74  0  0  0</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total number of cases with high heterogeneity: 6</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Total number of cases with low heterogeneity: 111</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Summary of the number of SKM-GN metabolites in each category:</span>
<span class="r-plt img"><img src="metab_meta_regression-2.png" alt="" width="700" height="433"></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                 SKM-GN</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> unique_metabs                      933</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> high_het_metabs_targeted             5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> high_het_metabs_untargeted_only      1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> meta_anal_metabs                   111</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "timewise_meta_regression" "training_meta_regression"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3] "meta_regression_results"  "meta_regression_models"  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [5] "metabolite_categories"   </span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

