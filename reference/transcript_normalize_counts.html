<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filter and normalize raw RNA-seq counts — transcript_normalize_counts • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter and normalize raw RNA-seq counts — transcript_normalize_counts"><meta name="description" content="Load raw counts and return the filtered and normalized data.
Alternatively, the user can provide a numeric data frame of raw RNA-seq counts."><meta property="og:description" content="Load raw counts and return the filtered and normalized data.
Alternatively, the user can provide a numeric data frame of raw RNA-seq counts."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filter and normalize raw RNA-seq counts</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/normalize_data.R" class="external-link"><code>R/normalize_data.R</code></a></small>
      <div class="d-none name"><code>transcript_normalize_counts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Load raw counts and return the filtered and normalized data.
Alternatively, the user can provide a numeric data frame of raw RNA-seq counts.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">transcript_normalize_counts</span><span class="op">(</span></span>
<span>  <span class="va">tissue</span>,</span>
<span>  min_cpm <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  min_num_samples <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  norm_method <span class="op">=</span> <span class="st">"TMM"</span>,</span>
<span>  counts <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tissue">tissue<a class="anchor" aria-label="anchor" href="#arg-tissue"></a></dt>
<dd><p>character, tissue abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a></p></dd>


<dt id="arg-min-cpm">min_cpm<a class="anchor" aria-label="anchor" href="#arg-min-cpm"></a></dt>
<dd><p>double, retain genes with more than <code>min_cpm</code> counts per million in at least <code>min_num_samples</code> samples</p></dd>


<dt id="arg-min-num-samples">min_num_samples<a class="anchor" aria-label="anchor" href="#arg-min-num-samples"></a></dt>
<dd><p>double, retain genes with more than <code>min_cpm</code> counts per million in at least <code>min_num_samples</code> samples</p></dd>


<dt id="arg-norm-method">norm_method<a class="anchor" aria-label="anchor" href="#arg-norm-method"></a></dt>
<dd><p>character, one of <code>c("TMM","TMMwsp","RLE","upperquartile","none")</code>. "TMM" by default.</p></dd>


<dt id="arg-counts">counts<a class="anchor" aria-label="anchor" href="#arg-counts"></a></dt>
<dd><p>optional user-supplied numeric data frame or matrix where row names are
gene IDs and column names are sample identifiers</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>data frame where row names are feature_ID and column names are viallabel</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Note that while this function is identical to the code used to generate the
normalized RNA-seq data tables (<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_NORM_DATA.html">MotrpacRatTraining6moData::TRNSCRPT_NORM_DATA</a>)
and the normalized RNA-seq data available through the MoTrPAC Data Hub,
<code>transcript_normalize_counts(tissue)</code> yields slightly fewer genes than its
corresponding <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_NORM_DATA.html">MotrpacRatTraining6moData::TRNSCRPT_NORM_DATA</a> object.
Investigation of this discrepancy suggests minor functional differences in the
version of <code><a href="https://rdrr.io/pkg/edgeR/man/cpm.html" class="external-link">edgeR::cpm()</a></code> used ~2.5 years apart. Find more details in
<a href="https://github.com/MoTrPAC/MotrpacRatTraining6moData/issues/41" class="external-link">this GitHub issue</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_NORM_DATA.html">MotrpacRatTraining6moData::TRNSCRPT_NORM_DATA</a></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">norm_data</span> <span class="op">=</span> <span class="fu">transcript_normalize_counts</span><span class="op">(</span><span class="st">"LUNG"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Simulate "user-supplied data"</span></span></span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">=</span> <span class="fu"><a href="load_sample_data.html">load_sample_data</a></span><span class="op">(</span><span class="st">"LUNG"</span>, <span class="st">"TRNSCRPT"</span>, normalized<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_LUNG_RAW_COUNTS</span>
<span class="r-in"><span><span class="va">counts</span> <span class="op">=</span> <span class="fu"><a href="df_to_numeric.html">df_to_numeric</a></span><span class="op">(</span><span class="va">counts</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">norm_data</span> <span class="op">=</span> <span class="fu">transcript_normalize_counts</span><span class="op">(</span>counts <span class="op">=</span> <span class="va">counts</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

