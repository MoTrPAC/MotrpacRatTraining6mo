<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Take a set of differential analysis results, either for a specific tissue and ome or
from a user-supplied table, convert to GCT format, and write to file for GSEA."><title>Prepare GCT file for GSEA — prepare_gsea_input • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare GCT file for GSEA — prepare_gsea_input"><meta property="og:description" content="Take a set of differential analysis results, either for a specific tissue and ome or
from a user-supplied table, convert to GCT format, and write to file for GSEA."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Prepare GCT file for GSEA</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/HEAD/R/gsea.R" class="external-link"><code>R/gsea.R</code></a></small>
      <div class="d-none name"><code>prepare_gsea_input.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Take a set of differential analysis results, either for a specific tissue and ome or
from a user-supplied table, convert to GCT format, and write to file for GSEA.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prepare_gsea_input</span><span class="op">(</span></span>
<span>  tissue <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gene_id_type <span class="op">=</span> <span class="st">"gene_symbol"</span>,</span>
<span>  outdir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  outfile_prefix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  input <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cast_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"comparison_group"</span><span class="op">)</span>,</span>
<span>  feature_to_gene_map <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>tissue</dt>
<dd><p>character, tissue abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>. Must be specified if cusotm <code>input</code> is not provided.</p></dd>


<dt>assay</dt>
<dd><p>character, assay abbreviation, one of "PROT", "PHOSPHO", "TRNSCRPT", "ACETYL", "UBIQ"</p></dd>


<dt>gene_id_type</dt>
<dd><p>character, gene identifier type. Must match the gene ID type in the
gene set database you plan on using for GSEA.
One of "gene_symbol", "entrez", "ensembl", "refseq". Default: "gene_symbol"</p></dd>


<dt>outdir</dt>
<dd><p>character, output directory for GCT file. The directory is created if it does not already exist.
Current directory by default.</p></dd>


<dt>outfile_prefix</dt>
<dd><p>character, prefix for output GCT file. By default, this prefix
includes the specified tissue and assay and current date. Must be specified for custom input data.</p></dd>


<dt>input</dt>
<dd><p>optional data frame if the user wants to perform this analysis for
a custom set of differential analysis results.
Required columns are "tscore", "feature_ID", and <code>cast_vars</code>
OR "tscore", <code>cast_vars</code>, and the gene identifier
indicated by <code>gene_id_type</code>. If a "feature_ID" column exists but not
a column corresponding to <code>gene_id_type</code>, then <code>feature_to_gene_map</code>
must map between "feature_ID" and <code>gene_id_type</code>.</p></dd>


<dt>cast_vars</dt>
<dd><p>character vector of column names in the differential analysis results
that are used to convert the table from long to wide format, with t-scores as the value variable.
See <code><a href="https://Rdatatable.gitlab.io/data.table/reference/dcast.data.table.html" class="external-link">data.table::dcast()</a></code> for more details. Default: "sex", "comparison_group"</p></dd>


<dt>feature_to_gene_map</dt>
<dd><p>data frame, map between "feature_ID" and <code>gene_id_type</code>.
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/FEATURE_TO_GENE_FILT.html">MotrpacRatTraining6moData::FEATURE_TO_GENE_FILT</a> if not otherwise specified.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>character, path of the GCT file</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>T-scores from the timewise differential analysis results are used for scores.
Feature-level data is summarized into gene-level data using the maximum absolute t-score.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Input for GSEA where gene set databases use gene symbols as IDs.</span></span></span>
<span class="r-in"><span><span class="co"># This applies for the default gene set database </span></span></span>
<span class="r-in"><span><span class="co"># when 'method="gsea"' in 'ssGSEA2_wrapper()'.</span></span></span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"HEART"</span>,<span class="st">"PROT"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PROT_HEART_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_HEART_PROT_20230127.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [8760x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_HEART_PROT_20230127.gct"</span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"PHOSPHO"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PHOSPHO_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_PHOSPHO_20230127.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [8120x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_PHOSPHO_20230127.gct"</span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"ACETYL"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ACETYL_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_ACETYL_20230127.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [2403x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_ACETYL_20230127.gct"</span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"UBIQ"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> UBIQ_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_UBIQ_20230127.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [2529x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_UBIQ_20230127.gct"</span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"TRNSCRPT"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_TRNSCRPT_20230127.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [14276x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_TRNSCRPT_20230127.gct"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Input for GSEA with Mitocarta (i.e., 'method="gsea_mitocarta"' </span></span></span>
<span class="r-in"><span><span class="co"># in 'ssGSEA2_wrapper()'), which uses RefSeq IDs </span></span></span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"TRNSCRPT"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span>,gene_id_type<span class="op">=</span><span class="st">"refseq"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_TRNSCRPT_20230127.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [17079x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_TRNSCRPT_20230127.gct"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># "Custom" input</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="combine_da_results.html">combine_da_results</a></span><span class="op">(</span>tissues <span class="op">=</span> <span class="st">"KIDNEY"</span>, assays <span class="op">=</span> <span class="st">"PROT"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PROT_KIDNEY_DA</span>
<span class="r-in"><span><span class="co"># add dummy column</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">gene_symbol</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">feature_ID</span></span></span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span>input<span class="op">=</span><span class="va">res</span>, outdir<span class="op">=</span><span class="st">"/tmp"</span>, outfile_prefix<span class="op">=</span><span class="st">"KIDNEY_PROT"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/KIDNEY_PROT.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [9852x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/KIDNEY_PROT.gct"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

