<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Prepare GCT file for GSEA — prepare_gsea_input • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Prepare GCT file for GSEA — prepare_gsea_input"><meta name="description" content="Take a set of differential analysis results, either for a specific tissue and ome or
from a user-supplied table, convert to GCT format, and write to file for GSEA."><meta property="og:description" content="Take a set of differential analysis results, either for a specific tissue and ome or
from a user-supplied table, convert to GCT format, and write to file for GSEA."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Prepare GCT file for GSEA</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/gsea.R" class="external-link"><code>R/gsea.R</code></a></small>
      <div class="d-none name"><code>prepare_gsea_input.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Take a set of differential analysis results, either for a specific tissue and ome or
from a user-supplied table, convert to GCT format, and write to file for GSEA.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">prepare_gsea_input</span><span class="op">(</span></span>
<span>  tissue <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  assay <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gene_id_type <span class="op">=</span> <span class="st">"gene_symbol"</span>,</span>
<span>  outdir <span class="op">=</span> <span class="st">"."</span>,</span>
<span>  outfile_prefix <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  input <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  cast_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"sex"</span>, <span class="st">"comparison_group"</span><span class="op">)</span>,</span>
<span>  feature_to_gene_map <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tissue">tissue<a class="anchor" aria-label="anchor" href="#arg-tissue"></a></dt>
<dd><p>character, tissue abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a>. Must be specified if cusotm <code>input</code> is not provided.</p></dd>


<dt id="arg-assay">assay<a class="anchor" aria-label="anchor" href="#arg-assay"></a></dt>
<dd><p>character, assay abbreviation, one of "PROT", "PHOSPHO", "TRNSCRPT", "ACETYL", "UBIQ"</p></dd>


<dt id="arg-gene-id-type">gene_id_type<a class="anchor" aria-label="anchor" href="#arg-gene-id-type"></a></dt>
<dd><p>character, gene identifier type. Must match the gene ID type in the
gene set database you plan on using for GSEA.
One of "gene_symbol", "entrez", "ensembl", "refseq". Default: "gene_symbol"</p></dd>


<dt id="arg-outdir">outdir<a class="anchor" aria-label="anchor" href="#arg-outdir"></a></dt>
<dd><p>character, output directory for GCT file. The directory is created if it does not already exist.
Current directory by default.</p></dd>


<dt id="arg-outfile-prefix">outfile_prefix<a class="anchor" aria-label="anchor" href="#arg-outfile-prefix"></a></dt>
<dd><p>character, prefix for output GCT file. By default, this prefix
includes the specified tissue and assay and current date. Must be specified for custom input data.</p></dd>


<dt id="arg-input">input<a class="anchor" aria-label="anchor" href="#arg-input"></a></dt>
<dd><p>optional data frame if the user wants to perform this analysis for
a custom set of differential analysis results.
Required columns are "tscore", "feature_ID", and <code>cast_vars</code>
OR "tscore", <code>cast_vars</code>, and the gene identifier
indicated by <code>gene_id_type</code>. If a "feature_ID" column exists but not
a column corresponding to <code>gene_id_type</code>, then <code>feature_to_gene_map</code>
must map between "feature_ID" and <code>gene_id_type</code>.</p></dd>


<dt id="arg-cast-vars">cast_vars<a class="anchor" aria-label="anchor" href="#arg-cast-vars"></a></dt>
<dd><p>character vector of column names in the differential analysis results
that are used to convert the table from long to wide format, with t-scores as the value variable.
See <code><a href="https://rdatatable.gitlab.io/data.table/reference/dcast.data.table.html" class="external-link">data.table::dcast()</a></code> for more details. Default: "sex", "comparison_group"</p></dd>


<dt id="arg-feature-to-gene-map">feature_to_gene_map<a class="anchor" aria-label="anchor" href="#arg-feature-to-gene-map"></a></dt>
<dd><p>data frame, map between "feature_ID" and <code>gene_id_type</code>.
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/FEATURE_TO_GENE_FILT.html">MotrpacRatTraining6moData::FEATURE_TO_GENE_FILT</a> if not otherwise specified.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>character, path of the GCT file</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>T-scores from the timewise differential analysis results are used for scores.
Feature-level data is summarized into gene-level data using the maximum absolute t-score.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Input for GSEA where gene set databases use gene symbols as IDs.</span></span></span>
<span class="r-in"><span><span class="co"># This applies for the default gene set database </span></span></span>
<span class="r-in"><span><span class="co"># when 'method="gsea"' in 'ssGSEA2_wrapper()'.</span></span></span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"HEART"</span>,<span class="st">"PROT"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PROT_HEART_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_HEART_PROT_20240930.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [8760x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_HEART_PROT_20240930.gct"</span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"PHOSPHO"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PHOSPHO_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_PHOSPHO_20240930.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [8120x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_PHOSPHO_20240930.gct"</span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"ACETYL"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> ACETYL_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_ACETYL_20240930.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [2403x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_ACETYL_20240930.gct"</span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"UBIQ"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> UBIQ_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_UBIQ_20240930.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [2529x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_UBIQ_20240930.gct"</span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"TRNSCRPT"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_TRNSCRPT_20240930.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [14276x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_TRNSCRPT_20240930.gct"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Input for GSEA with Mitocarta (i.e., 'method="gsea_mitocarta"' </span></span></span>
<span class="r-in"><span><span class="co"># in 'ssGSEA2_wrapper()'), which uses RefSeq IDs </span></span></span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span><span class="st">"LIVER"</span>,<span class="st">"TRNSCRPT"</span>,outdir<span class="op">=</span><span class="st">"/tmp"</span>,gene_id_type<span class="op">=</span><span class="st">"refseq"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> TRNSCRPT_LIVER_DA</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/MotrpacRatTraining6mo_gsea_LIVER_TRNSCRPT_20240930.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [17079x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/MotrpacRatTraining6mo_gsea_LIVER_TRNSCRPT_20240930.gct"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># "Custom" input</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="combine_da_results.html">combine_da_results</a></span><span class="op">(</span>tissues <span class="op">=</span> <span class="st">"KIDNEY"</span>, assays <span class="op">=</span> <span class="st">"PROT"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> PROT_KIDNEY_DA</span>
<span class="r-in"><span><span class="co"># add dummy column</span></span></span>
<span class="r-in"><span><span class="va">res</span><span class="op">$</span><span class="va">gene_symbol</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">feature_ID</span></span></span>
<span class="r-in"><span><span class="fu">prepare_gsea_input</span><span class="op">(</span>input<span class="op">=</span><span class="va">res</span>, outdir<span class="op">=</span><span class="st">"/tmp"</span>, outfile_prefix<span class="op">=</span><span class="st">"KIDNEY_PROT"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saving file to  /tmp/KIDNEY_PROT.gct </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Dimensions of matrix: [9852x8]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Setting precision to 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Saved.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "/tmp/KIDNEY_PROT.gct"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

