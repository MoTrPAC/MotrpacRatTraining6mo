<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>RRBS differential anlaysis — rrbs_differential_analysis • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RRBS differential anlaysis — rrbs_differential_analysis"><meta name="description" content="Timewise and training differential analysis wrapper for RRBS data."><meta property="og:description" content="Timewise and training differential analysis wrapper for RRBS data."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>RRBS differential anlaysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/rrbs_pipeline.R" class="external-link"><code>R/rrbs_pipeline.R</code></a></small>
      <div class="d-none name"><code>rrbs_differential_analysis.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Timewise and training differential analysis wrapper for RRBS data.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">rrbs_differential_analysis</span><span class="op">(</span></span>
<span>  <span class="va">y</span>,</span>
<span>  PHENO <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/PHENO.html">PHENO</a></span>,</span>
<span>  METHYL_META <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/METHYL_META.html">METHYL_META</a></span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  adj_pct_unaligned <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  samples_to_remove <span class="op">=</span> <span class="fu">data.table</span><span class="fu">::</span><span class="fu"><a href="https://rdatatable.gitlab.io/data.table/reference/data.table.html" class="external-link">data.table</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/OUTLIERS.html">OUTLIERS</a></span><span class="op">)</span><span class="op">[</span><span class="va">assay</span></span>
<span>    <span class="op">==</span> <span class="st">"METHYL"</span>, <span class="va">viallabel</span><span class="op">]</span>,</span>
<span>  edger_tol <span class="op">=</span> <span class="fl">1e-05</span>,</span>
<span>  dataset_name <span class="op">=</span> <span class="st">""</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/pkg/edgeR/man/DGEList.html" class="external-link">edgeR::DGEList()</a></code> object.
yall$genes is a metadata data frame with the locus coordinates (see details), and these fields at minimum:
Chr, EntrezID, Symbol, and Strand</p></dd>


<dt id="arg-pheno">PHENO<a class="anchor" aria-label="anchor" href="#arg-pheno"></a></dt>
<dd><p>A data frame with a row per sample. Contains at least the following columns: "sex", "group".
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/PHENO.html">MotrpacRatTraining6moData::PHENO</a> by default.</p></dd>


<dt id="arg-methyl-meta">METHYL_META<a class="anchor" aria-label="anchor" href="#arg-methyl-meta"></a></dt>
<dd><p>A data frame with a row per sample.
Contains the RRBS pipeline QA/QC scores. Contains at least the following columns: "pct_Unaligned".
<a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/METHYL_META.html">MotrpacRatTraining6moData::METHYL_META</a> by default.</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>A logical. TRUE: comments about the pipeline progress are printed.</p></dd>


<dt id="arg-adj-pct-unaligned">adj_pct_unaligned<a class="anchor" aria-label="anchor" href="#arg-adj-pct-unaligned"></a></dt>
<dd><p>A logical. TRUE: adjust for percent unaligned reads. Default is FALSE.</p></dd>


<dt id="arg-samples-to-remove">samples_to_remove<a class="anchor" aria-label="anchor" href="#arg-samples-to-remove"></a></dt>
<dd><p>A character vector. Contains the ids of the samples that should be removed
(e.g., identified outliers or failed samples).
METHYL samples in <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/OUTLIERS.html">MotrpacRatTraining6moData::OUTLIERS</a> by default.</p></dd>


<dt id="arg-edger-tol">edger_tol<a class="anchor" aria-label="anchor" href="#arg-edger-tol"></a></dt>
<dd><p>A number. An internal parameter of edgeR. Default is 1e-05. Consider increasing if the algorithm takes too long.</p></dd>


<dt id="arg-dataset-name">dataset_name<a class="anchor" aria-label="anchor" href="#arg-dataset-name"></a></dt>
<dd><p>A character. The name of the current dataset. Will be added to the output.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list.First item is called timewise and will contain the contrast-specific differential analysis results.
Second item is called training and contains the overall training-level significance per locus.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">PHENO</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">METHYL_META</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Raw data by tissue are available as RData files in Google Cloud Storage with the following URLs:   </span></span></span>
<span class="r-in"><span><span class="co"># Brown adipose:</span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/METHYL_BAT_RAW_DATA.rda</span></span></span>
<span class="r-in"><span><span class="co"># Heart: </span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/METHYL_HEART_RAW_DATA.rda</span></span></span>
<span class="r-in"><span><span class="co"># Hippocampus: </span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/METHYL_HIPPOC_RAW_DATA.rda</span></span></span>
<span class="r-in"><span><span class="co"># Kidney: </span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/METHYL_KIDNEY_RAW_DATA.rda</span></span></span>
<span class="r-in"><span><span class="co"># Lung: </span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/METHYL_LUNG_RAW_DATA.rda</span></span></span>
<span class="r-in"><span><span class="co"># Liver: </span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/METHYL_LIVER_RAW_DATA.rda</span></span></span>
<span class="r-in"><span><span class="co"># Gastrocnemius: </span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/METHYL_SKMGN_RAW_DATA.rda</span></span></span>
<span class="r-in"><span><span class="co"># White adipose: </span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/METHYL_WATSC_RAW_DATA.rda</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load_methyl_raw_data() can be used to download data for a tissue, e.g.,</span></span></span>
<span class="r-in"><span><span class="co"># download the gastrocnemius data and load the data object into this session:</span></span></span>
<span class="r-in"><span><span class="va">yall</span> <span class="op">=</span> <span class="fu"><a href="load_methyl_raw_data.html">load_methyl_raw_data</a></span><span class="op">(</span><span class="st">"SKM-GN"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># for the simplicity of this example, we subset the data to 5000 loci</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="va">yall</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5000</span>,<span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">dea_res</span> <span class="op">=</span> <span class="fu">rrbs_differential_analysis</span><span class="op">(</span><span class="va">y</span>,<span class="va">PHENO</span>,<span class="va">METHYL_META</span>,adj_pct_unaligned<span class="op">=</span><span class="cn">T</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dea_res</span><span class="op">$</span><span class="va">timewise</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">dea_res</span><span class="op">$</span><span class="va">training</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Alternatively, you can use the processed datasets.</span></span></span>
<span class="r-in"><span><span class="co"># These are also available through the Google Cloud directory:</span></span></span>
<span class="r-in"><span><span class="co"># https://storage.googleapis.com/motrpac-rat-training-6mo-extdata/</span></span></span>
<span class="r-in"><span><span class="co"># File formats are \code{METHYL_XXX_NORM_DATA.rda} and \code{METHYL_XXX_DA.rda} </span></span></span>
<span class="r-in"><span><span class="co"># where XXX is the tissue name:</span></span></span>
<span class="r-in"><span><span class="co"># BAT (brown adipose), HEART, HIPPOC (hippocampus), KIDNEY, LUNG, LIVER, </span></span></span>
<span class="r-in"><span><span class="co"># SKMGN (gastrocnemius skeletal muscle), and WATSC (white adipose)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># You can use load_sample_data() to download and load the normalized data, e.g.:</span></span></span>
<span class="r-in"><span><span class="va">y_processed</span> <span class="op">=</span> <span class="fu"><a href="load_sample_data.html">load_sample_data</a></span><span class="op">(</span><span class="st">"SKM-GN"</span>, <span class="st">"METHYL"</span>, normalized <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># again, for the simplicity of this example, we subset the data to 5000 loci</span></span></span>
<span class="r-in"><span><span class="va">y</span> <span class="op">=</span> <span class="va">y_processed</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">5000</span>,<span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">)</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">da_res</span> <span class="op">=</span> <span class="fu">rrbs_differential_analysis</span><span class="op">(</span><span class="va">y</span>, adj_pct_unaligned<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">da_res</span><span class="op">$</span><span class="va">timewise</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">da_res</span><span class="op">$</span><span class="va">training</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

