<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>RNA-seq timewise differential analysis — transcript_timewise_da • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="RNA-seq timewise differential analysis — transcript_timewise_da"><meta name="description" content="Use DESeq2 to perform pairwise contrasts between each group of trained animals
and the sex-matched control group for a single tissue. Analysis is performed separately for males and
females."><meta property="og:description" content="Use DESeq2 to perform pairwise contrasts between each group of trained animals
and the sex-matched control group for a single tissue. Analysis is performed separately for males and
females."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.6</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>RNA-seq timewise differential analysis</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/main/R/transcript_differential_analysis.R" class="external-link"><code>R/transcript_differential_analysis.R</code></a></small>
      <div class="d-none name"><code>transcript_timewise_da.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Use DESeq2 to perform pairwise contrasts between each group of trained animals
and the sex-matched control group for a single tissue. Analysis is performed separately for males and
females.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">transcript_timewise_da</span><span class="op">(</span></span>
<span>  <span class="va">tissue</span>,</span>
<span>  covariates <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"pct_globin"</span>, <span class="st">"RIN"</span>, <span class="st">"pct_umi_dup"</span>, <span class="st">"median_5_3_bias"</span><span class="op">)</span>,</span>
<span>  outliers <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/na.fail.html" class="external-link">na.omit</a></span><span class="op">(</span><span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/OUTLIERS.html">OUTLIERS</a></span><span class="op">$</span><span class="va">viallabel</span><span class="op">)</span>,</span>
<span>  add_shrunk_logfc <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  rdata_outfile <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  overwrite <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-tissue">tissue<a class="anchor" aria-label="anchor" href="#arg-tissue"></a></dt>
<dd><p>character, tissue abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a></p></dd>


<dt id="arg-covariates">covariates<a class="anchor" aria-label="anchor" href="#arg-covariates"></a></dt>
<dd><p>character vector of covariates that correspond to column names of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRNSCRPT_META.html">MotrpacRatTraining6moData::TRNSCRPT_META</a>.
Defaults to covariates that were used for the manuscript.</p></dd>


<dt id="arg-outliers">outliers<a class="anchor" aria-label="anchor" href="#arg-outliers"></a></dt>
<dd><p>vector of viallabels to exclude during differential analysis. Defaults
to <code>[MotrpacRatTraining6moData::OUTLIERS\$viallabel[[MotrpacRatTraining6moData::OUTLIERS]$assay == "TRNSCRPT"]</code></p></dd>


<dt id="arg-add-shrunk-logfc">add_shrunk_logfc<a class="anchor" aria-label="anchor" href="#arg-add-shrunk-logfc"></a></dt>
<dd><p>boolean, whether to calculate shrunk log fold-changes in addition to standard log fold-changes</p></dd>


<dt id="arg-rdata-outfile">rdata_outfile<a class="anchor" aria-label="anchor" href="#arg-rdata-outfile"></a></dt>
<dd><p>NULL or path in which to save DESeq2 objects in an RData file</p></dd>


<dt id="arg-overwrite">overwrite<a class="anchor" aria-label="anchor" href="#arg-overwrite"></a></dt>
<dd><p>boolean, whether to overwrite the file if <code>rdata_outfile</code> exists</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>boolean, whether to print messages</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a data frame with one row per gene per contrast (usually 8 rows per gene):</p><dl><dt><code>feature_ID</code></dt>
<dd><p>character, MoTrPAC feature identifier</p></dd>

<dt><code>sex</code></dt>
<dd><p>character, one of 'male' or 'female'</p></dd>

<dt><code>comparison_group</code></dt>
<dd><p>character, time point of trained animals compared to the sex-matched sedentary control animals, one of '1w', '2w', '4w', '8w'</p></dd>

<dt><code>assay</code></dt>
<dd><p>character, assay abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/ASSAY_ABBREV.html">MotrpacRatTraining6moData::ASSAY_ABBREV</a></p></dd>

<dt><code>assay_code</code></dt>
<dd><p>character, assay code used in data release. See <a href="https://rdrr.io/pkg/MotrpacBicQC/man/assay_codes.html" class="external-link">MotrpacBicQC::assay_codes</a>.</p></dd>

<dt><code>tissue</code></dt>
<dd><p>character, tissue abbreviation, one of <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TISSUE_ABBREV.html">MotrpacRatTraining6moData::TISSUE_ABBREV</a></p></dd>

<dt><code>tissue_code</code></dt>
<dd><p>character, tissue code used in data release. See <a href="https://rdrr.io/pkg/MotrpacBicQC/man/bic_animal_tissue_code.html" class="external-link">MotrpacBicQC::bic_animal_tissue_code</a>.</p></dd>

<dt><code>covariates</code></dt>
<dd><p>character, comma-separated list of adjustment variables</p></dd>

<dt><code>removed_samples</code></dt>
<dd><p>character, comma-separated list of outliers (vial labels) removed from differential analysis</p></dd>

<dt><code>logFC</code></dt>
<dd><p>double, log fold-change where the numerator is 'comparison_group', e.g., '1w', and the denominator is the group of sex-matched sedentary control animals</p></dd>

<dt><code>logFC_se</code></dt>
<dd><p>double, standard error of the log fold-change</p></dd>

<dt><code>shrunk_logFC</code></dt>
<dd><p>double, log fold-change shrunk with <code>type = 'ashr'</code> and <code>optmethod = 'mixSQP'</code>,
only if <code>add_shrunk_logfc = TRUE</code></p></dd>

<dt><code>shrunk_logFC_se</code></dt>
<dd><p>double, standard error of <code>shrunk_logFC</code>, only if <code>add_shrunk_logfc = TRUE</code></p></dd>

<dt><code>zscore</code></dt>
<dd><p>double, Wald statistic</p></dd>

<dt><code>p_value</code></dt>
<dd><p>double, unadjusted p-value for the difference between 'comparison_group' and the group of sex-matched sedentary control animals</p></dd>

<dt><code>comparison_average_intensity</code></dt>
<dd><p>double, average intensity among the replicates in 'comparison_group'</p></dd>

<dt><code>comparison_average_intensity_se</code></dt>
<dd><p>double, standard error of 'comparison_average_intensity'</p></dd>

<dt><code>reference_average_intensity</code></dt>
<dd><p>double, average intensity among the replicates in the group of sex-matched sedentary control animals</p></dd>

<dt><code>reference_average_intensity_se</code></dt>
<dd><p>double, standard error of 'reference_average_intensity'</p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># Perform differential analysis for expressed genes in brown adipose tissue </span></span></span>
<span class="r-in"><span><span class="co"># with default parameters, i.e., outliers and covariates used for the manuscript; </span></span></span>
<span class="r-in"><span><span class="co"># calculate both standard and shrunk log fold-changes</span></span></span>
<span class="r-in"><span><span class="va">da</span> <span class="op">=</span> <span class="fu">transcript_timewise_da</span><span class="op">(</span><span class="st">"BAT"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as above but don't calculate shrunk log fold-changes</span></span></span>
<span class="r-in"><span><span class="va">da</span> <span class="op">=</span> <span class="fu">transcript_timewise_da</span><span class="op">(</span><span class="st">"BAT"</span>, add_shrunk_logfc <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Same as the first example but save the [DESeq2::DESeq2()] DESeqResults objects in an RData file </span></span></span>
<span class="r-in"><span><span class="va">da</span> <span class="op">=</span> <span class="fu">transcript_timewise_da</span><span class="op">(</span><span class="st">"BAT"</span>, rdata_outfile <span class="op">=</span> <span class="st">"~/test/BAT_RNA_DA.RData"</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

