<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Perform pathway enrichment for a list of genes.
Wrapper for gprofiler2::gost()."><title>Gene pathway enrichment — gene_pathway_enrichment • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Gene pathway enrichment — gene_pathway_enrichment"><meta property="og:description" content="Perform pathway enrichment for a list of genes.
Wrapper for gprofiler2::gost()."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.6.5</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/key_metabolites.html">Key metabolites</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Gene pathway enrichment</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/HEAD/R/pathway_enrichment.R" class="external-link"><code>R/pathway_enrichment.R</code></a></small>
      <div class="d-none name"><code>gene_pathway_enrichment.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform pathway enrichment for a list of genes.
Wrapper for <code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gene_pathway_enrichment</span><span class="op">(</span></span>
<span>  <span class="va">input</span>,</span>
<span>  <span class="va">background</span>,</span>
<span>  organism <span class="op">=</span> <span class="st">"rnorvegicus"</span>,</span>
<span>  databases <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"REAC"</span>, <span class="st">"WP"</span>, <span class="st">"KEGG"</span><span class="op">)</span>,</span>
<span>  min_pw_set_size <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_pw_set_size <span class="op">=</span> <span class="fl">200</span>,</span>
<span>  return_gem <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>input</dt>
<dd><p>vector of gene identifiers</p></dd>


<dt>background</dt>
<dd><p>vector of gene identifiers in universe/background. Must include the
input. Should include all genes that were candidates for <code>input</code>, e.g.,
expressed genes. If performing pathway enrichment on genes identified through <code>MotrpacRatTraining6moData</code>,
see <a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GENE_UNIVERSES.html">MotrpacRatTraining6moData::GENE_UNIVERSES</a>. See <code>custom_bg</code> argument for <code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code>.</p></dd>


<dt>organism</dt>
<dd><p>character, species name. Default: "rnorvegicus" See <code>organism</code>
argument for <code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code>.</p></dd>


<dt>databases</dt>
<dd><p>character, vector of databases in which to search. See <code>sources</code>
argument for <code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code>.</p></dd>


<dt>min_pw_set_size</dt>
<dd><p>integer, exclude pathways smaller than this. Default: 10</p></dd>


<dt>max_pw_set_size</dt>
<dd><p>integer, exclude pathways larger than this. Default: 200</p></dd>


<dt>return_gem</dt>
<dd><p>bool, whether to return a data frame compatible with the
Generic Enrichment Map (GEM) file format, which can be used as an input for the
<a href="https://apps.cytoscape.org/apps/enrichmentmap" class="external-link">Cytoscape EnrichmentMap application</a>.
Default: FALSE</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>a data frame of pathway enrichment results. If <code>return_gem=TRUE</code>,
column names are changed add added to be compatible with the Generic Enrichment Map (GEM) file format.
Otherwise, the columns are defined as follows:</p><dl><dt><code>query</code></dt>
<dd><p>character, the name of the input query which by default is the order of query with the prefix "query_"</p></dd>

<dt><code>significant</code></dt>
<dd><p>bool, whether the <code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code> enrichment p-value is less than 0.05</p></dd>

<dt><code>term_size</code></dt>
<dd><p>integer, number of genes that are annotated to the term</p></dd>

<dt><code>query_size</code></dt>
<dd><p>integer, number of genes that were included in the query (from <code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code>)</p></dd>

<dt><code>intersection_size</code></dt>
<dd><p>integer, the number of genes in the input query that are annotated to the corresponding term</p></dd>

<dt><code>precision</code></dt>
<dd><p>double, the proportion of genes in the input list that are annotated to the function, defined as <code>intersection_size/query_size</code></p></dd>

<dt><code>recall</code></dt>
<dd><p>double, the proportion of functionally annotated genes that the query recovers, defined as <code>intersection_size/term_size</code></p></dd>

<dt><code>term_id</code></dt>
<dd><p>character, unique term/pathway identifier</p></dd>

<dt><code>source</code></dt>
<dd><p>character, the abbreviation of the data source for the term/pathway</p></dd>

<dt><code>term_name</code></dt>
<dd><p>character, term/pathway name</p></dd>

<dt><code>effective_domain_size</code></dt>
<dd><p>integer, the total number of genes in the universe used for the hypergeometric test</p></dd>

<dt><code>source_order</code></dt>
<dd><p>integer, numeric order for the term within its data source</p></dd>

<dt><code>parents</code></dt>
<dd><p>list of term IDs that are hierarchically directly above the term.
For non-hierarchical data sources this points to an artificial root node</p></dd>

<dt><code>evidence_codes</code></dt>
<dd><p>character, comma-separated evidence codes</p></dd>

<dt><code>intersection</code></dt>
<dd><p>character, input gene IDs that intersect with the term/pathway</p></dd>

<dt><code>gost_adj_p_value</code></dt>
<dd><p>double, improperly adjusted hypergeometric p-value
from <code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code>. For reference only; should not be used to filter results
unless there was only a single list of genes in the input.</p></dd>

<dt><code>computed_p_value</code></dt>
<dd><p>double, nominal hypergeometric p-value,
computed from the <code><a href="https://rdrr.io/pkg/gprofiler2/man/gost.html" class="external-link">gprofiler2::gost()</a></code> output</p></dd>

<dt><code>BH_adj_p_value</code></dt>
<dd><p>double, BH-adjusted p-values, calculated on <code>computed_p_value</code></p></dd>


</dl></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Perform pathway enrichment for differential transcripts in the liver</span></span></span>
<span class="r-in"><span><span class="va">diff</span> <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/TRAINING_REGULATED_FEATURES.html">TRAINING_REGULATED_FEATURES</a></span></span></span>
<span class="r-in"><span><span class="va">input_feat</span> <span class="op">=</span> <span class="va">diff</span><span class="op">$</span><span class="va">feature_ID</span><span class="op">[</span><span class="va">diff</span><span class="op">$</span><span class="va">tissue</span> <span class="op">==</span> <span class="st">"LIVER"</span> <span class="op">&amp;</span> <span class="va">diff</span><span class="op">$</span><span class="va">assay</span> <span class="op">==</span> <span class="st">"TRNSCRPT"</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">map</span> <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/FEATURE_TO_GENE_FILT.html">FEATURE_TO_GENE_FILT</a></span></span></span>
<span class="r-in"><span><span class="va">input</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="va">map</span><span class="op">$</span><span class="va">gene_symbol</span><span class="op">[</span><span class="va">map</span><span class="op">$</span><span class="va">feature_ID</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="va">input_feat</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">background</span> <span class="op">=</span> <span class="fu">MotrpacRatTraining6moData</span><span class="fu">::</span><span class="va"><a href="https://motrpac.github.io/MotrpacRatTraining6moData/reference/GENE_UNIVERSES.html">GENE_UNIVERSES</a></span><span class="op">$</span><span class="va">gene_symbol</span><span class="op">$</span><span class="va">TRNSCRPT</span><span class="op">$</span><span class="va">LIVER</span></span></span>
<span class="r-in"><span><span class="va">res</span> <span class="op">=</span> <span class="fu">gene_pathway_enrichment</span><span class="op">(</span><span class="va">input</span>, <span class="va">background</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">res</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     query significant term_size query_size intersection_size  precision</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 query_1        TRUE        18        253                 8 0.03162055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 query_1        TRUE        17        253                 8 0.03162055</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 query_1        TRUE        17        253                 6 0.02371542</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 query_1        TRUE        62        253                 9 0.03557312</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 query_1        TRUE        13        253                 5 0.01976285</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 query_1        TRUE       104        253                11 0.04347826</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      recall            term_id source                      term_name</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.4444444         KEGG:00100   KEGG           Steroid biosynthesis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.4705882           WP:WP632     WP         Cholesterol metabolism</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3 0.3529412  REAC:R-RNO-191273   REAC       Cholesterol biosynthesis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4 0.1451613 REAC:R-RNO-8957322   REAC         Metabolism of steroids</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5 0.3846154 REAC:R-RNO-3371571   REAC HSF1-dependent transactivation</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 0.1057692  REAC:R-RNO-211859   REAC          Biological oxidations</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   effective_domain_size source_order            parents</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                 13525           13         KEGG:00000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                 13525           60          WP:000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                 13525          273 REAC:R-RNO-8957322</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4                 13525          819  REAC:R-RNO-556833</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                 13525          621 REAC:R-RNO-3371556</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6                 13525          170 REAC:R-RNO-1430728</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                           evidence_codes</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                KEGG,KEGG,KEGG,KEGG,KEGG,KEGG,KEGG,KEGG</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                                WP,WP,WP,WP,WP,WP,WP,WP</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                          REAC,REAC,REAC,REAC,REAC,REAC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4           REAC,REAC,REAC,REAC,REAC,REAC,REAC,REAC,REAC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                               REAC,REAC,REAC,REAC,REAC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 REAC,REAC,REAC,REAC,REAC,REAC,REAC,REAC,REAC,REAC,REAC</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                                                              intersection</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                         Hsd17b7,Cyp51,Sqle,Dhcr7,Tm7sf2,Fdft1,Msmo1,Lss</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2                               Idi1,Apoc2,Dhcr7,Fdft1,Msmo1,Fdps,Mvk,Lss</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3                                     Cyp51,Sqle,Dhcr7,Tm7sf2,Fdft1,Msmo1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4             Cyp51,Serpina6,Sqle,Slc27a5,Stard4,Dhcr7,Tm7sf2,Fdft1,Msmo1</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5                                        Fkbp4,Cryab,Hsp90ab1,Hspb8,Hspa8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6 Tpst1,Nnmt,Cyp51,Ugp2,Cyb5r3,Glyat,Gclm,Slc26a2,Hsp90ab1,Cyp2a1,Cyp4f39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   gost_adj_p_value computed_p_value BH_adj_p_value</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1     1.284439e-07     4.997818e-10   1.526833e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2     1.806063e-08     2.821974e-10   1.526833e-07</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3     9.186971e-05     4.204563e-07   8.563294e-05</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4     2.738559e-04     2.078412e-06   3.063176e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5     2.738559e-04     2.506691e-06   3.063176e-04</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6     3.319231e-04     3.797747e-06   3.867372e-04</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

