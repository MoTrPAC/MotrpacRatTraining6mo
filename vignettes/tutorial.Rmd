---
title: "Tutorial for MotrpacRatTraining6mo R package"
author: "Nicole R. Gay, David Amar, Pierre Jean Beltran"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette:
  toc: true
  code_folding: show 
  toc_depth: 4
  toc_float:
    collapsed: false
    smooth_scroll: false

vignette: >
  %\VignetteIndexEntry{Tutorial for MotrpacRatTraining6mo R package}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
  %\usepackage[utf8]{inputenc}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

## Introduction 

### About this package 
This package provides functions to fetch, explore, and reproduce the processed 
data and downstream analysis results presented in the main paper for the first 
large-scale multi-omic multi-tissue endurance exercise training study conducted 
in young adult rats by the Molecular Transducers of Physical Activity Consortium 
(MoTrPAC). *A [bioRxiv](https://www.biorxiv.org/) link to the corresponding 
preprint will be added shortly.* 

While some of the functions in this package can be used by themselves, they
were primarily written to analyze data in the 
[MotrpacRatTraining6moData](https://github.com/MoTrPAC/MotrpacRatTraining6moData)
R package. *A link to the MotrpacRatTraining6moData vignette
will be added shortly.*  

### About MoTrPAC 
MoTrPAC is a national research consortium designed to discover and perform 
preliminary characterization of the range of molecular transducers (the 
"molecular map") that underlie the effects of physical activity in humans. 
The program's goal is to study the molecular changes that occur during and after 
exercise and ultimately to advance the understanding of how physical activity 
improves and preserves health. The six-year program is the largest targeted NIH 
investment of funds into the mechanisms of how physical activity improves health 
and prevents disease. See [motrpac.org](https://www.motrpac.org/) and 
[motrpac-data.org](https://motrpac-data.org/) for more details. 

### Installation
Install this package with `devtools`:
```r
if (!require("devtools", quietly = TRUE)){
  install.packages("devtools")
}
devtools::install_github("MoTrPAC/MotrpacRatTraining6mo")
```

Once we install this package, we can load the library. 
```{r setup}
library(MotrpacRatTraining6mo)
```

## Study design 
Details of the experimental design can be found in the supplementary methods 
of the bioRxiv preprint (TODO: add link). Briefly, 6-month-old young adult rats 
were subjected to progressive endurance exercise training
for 1, 2, 4, or 8 weeks, with tissues collected 48 hours after the last training bout. 
Sex-matched sedentary, untrained rats were used as controls. Whole blood, plasma, 
and 18 solid tissues were analyzed using genomics, proteomics, metabolomics, 
and protein immunoassay technologies, with most assays performed in a subset of these tissues. 
Depending on the assay, between 3 and 5 replicates per sex per time point were
analyzed. 

## Tissue and assay abbreviations  
It is important to be aware of the tissue and assay abbreviations because they are used
to name data objects and define arguments for many functions.  

### Tissues
* ADRNL: adrenal gland  
* BAT: brown adipose tissue  
* BLOOD: whole blood  
* COLON: colon  
* CORTEX: cerebral cortex  
* HEART: heart  
* HIPPOC: hippocampus  
* HYPOTH: hypothalamus  
* KIDNEY: kidney  
* LIVER: liver  
* LUNG: lung  
* OVARY: ovaries (female gonads)  
* PLASMA: plasma from blood
* SKM-GN: gastrocnemius (leg skeletal muscle)  
* SKM-VL: vastus lateralis (leg skeletal muscle) 
* SMLINT: small intestine  
* SPLEEN: spleen  
* TESTES: testes (male gonads)  
* VENACV: vena cava  
* WAT-SC: subcutaneous white adipose tissue  

### Assays/omes
* ACETYL: acetylproteomics; protein site acetylation  
* ATAC: chromatin accessibility, ATAC-seq data  
* IMMUNO: multiplexed immunoassays (cytokines and hormones)  
* METAB: metabolomics and lipidomics  
* METHYL: DNA methylation, RRBS data   
* PHOSPHO: phosphoproteomics; protein site phosphorylation  
* PROT: global proteomics; protein abundance  
* TRNSCRPT: transcriptomics, RNA-Seq data  
* UBIQ: ubiquitylome; protein site ubiquitination  

## Associated data 
While some of the functions in this package can be used by themselves, they
were primarily written to analyze data in the 
[MotrpacRatTraining6moData](https://github.com/MoTrPAC/MotrpacRatTraining6moData)
R package. 

Here is a brief summary of the kinds of data included in 
[MotrpacRatTraining6moData](https://github.com/MoTrPAC/MotrpacRatTraining6moData):
* Raw counts for RNA-Seq (TRNSCRPT), ATAC-Seq (ATAC), and RRBS (METHYL) data, 
e.g., `TRNSCRPT_LIVER_RAW_COUNTS`.
Note that epigenetic data (ATAC and METHYL) must be downloaded from Google Cloud Storage.  
* Normalized sample-level data, e.g., `TRNSCRPT_SKMGN_NORM_DATA`   
* Differential analysis results, e.g., `HEART_PROT_DA` (see more details below)  
* 

This package includes several functions to easily fetch and compile data from 
specified tissues and assays.

```{r}

```


For the data-specific tutorial, see TODO. 
`list_available_data("MotrpacRatTraining6moData")`

For more details about the [MotrpacRatTraining6moData](https://github.com/MoTrPAC/MotrpacRatTraining6moData)
R package, see its vignette (TODO).

## Differential analysis 

i.e., *timewise* summary statistics (pairwise contrasts between each group of 
trained animals at a given time point and the sex-matched sedentary control animals) and *training* and adjusted p-values from the 

## Bayesian graphical clustering 

### Reproduce our results or run your own analysis 

### Explore graphical clustering results

## Pathway enrichment of clusters

## Visualization of pathway enrichment results 

## Getting help 
For questions, bug reporting, and feature requests for this package, please 
[submit a new issue](https://github.com/MoTrPAC/MotrpacRatTraining6mo/issues) 
and include as many details as possible. 

If the concern is related to data provided in the `MotrpacRatTraining6moData`
package, please submit an issue 
[here](https://github.com/MoTrPAC/MotrpacRatTraining6moData/issues) instead. 

## Acknowledgements 
MoTrPAC is supported by the National Institutes of Health (NIH) Common
Fund through cooperative agreements managed by the National Institute of Diabetes and
Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal
Diseases (NIAMS), and National Institute on Aging (NIA). 
