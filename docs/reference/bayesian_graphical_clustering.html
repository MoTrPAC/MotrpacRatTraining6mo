<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Perform Bayesian graphical clustering of the differential analysis results using repfdr"><title>Bayesian graphical clustering — bayesian_graphical_clustering • MotrpacRatTraining6mo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.3/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.3/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian graphical clustering — bayesian_graphical_clustering"><meta property="og:description" content="Perform Bayesian graphical clustering of the differential analysis results using repfdr"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">MotrpacRatTraining6mo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item">
  <a class="nav-link" href="../articles/MotrpacRatTraining6mo.html">Get started</a>
</li>
<li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Bayesian graphical clustering</h1>
      <small class="dont-index">Source: <a href="https://github.com/MoTrPAC/MotrpacRatTraining6mo/blob/HEAD/R/bayesian_graphical_clustering.R" class="external-link"><code>R/bayesian_graphical_clustering.R</code></a></small>
      <div class="d-none name"><code>bayesian_graphical_clustering.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Perform Bayesian graphical clustering of the differential analysis results using <code>repfdr</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">bayesian_graphical_clustering</span><span class="op">(</span></span>
<span>  <span class="va">zscores</span>,</span>
<span>  min_analyte_posterior_thr <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  min_prior_for_config <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  df <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  naive_edge_sets <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>zscores</dt>
<dd><p>A numeric matrix. Rows are analytes, columns are conditions (e.g., male week 1). Entries are z-scores.</p></dd>


<dt>min_analyte_posterior_thr</dt>
<dd><p>A number. The minimal value of sum of posteriors for including an analyte.</p></dd>


<dt>min_prior_for_config</dt>
<dd><p>A number. The minimal prior probability on the configuration priors.</p></dd>


<dt>df</dt>
<dd><p>Integer. Parameter for <code><a href="https://rdrr.io/pkg/repfdr/man/ztobins.html" class="external-link">repfdr::ztobins()</a></code>. Degrees of freedom for fitting the estimated density f(z).</p></dd>


<dt>naive_edge_sets</dt>
<dd><p>A logical. TRUE: edge sets are extracted by taking simple intersection of nodes.
FALSE: edge sets are extracted from the repfdr solution.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A named list with three items:</p><dl><dt><code>node_sets</code></dt>
<dd><p>named list of node sets</p></dd>

<dt><code>edge_sets</code></dt>
<dd><p>named list of edge sets</p></dd>

<dt><code>repfdr_results</code></dt>
<dd><p>repfdr EM solution</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is highly specialized for the MoTrPAC data. It assumes that the input zscore matrix has eight columns.
Four columns for male z-scores (weeks 1, 2, 4, 8), and four for females. No NA values in the input matrix.
The function first runs the Bayesian clustering using <code>repfdr</code> (see <code><a href="repfdr_wrapper.html">repfdr_wrapper()</a></code>) and then extracts the node and
edge sets of the graphical solution.</p>
<p>A node is a time-point specific state. It can represent null features (z-score around zero, no effect), up-regulated
features (positive z-score), or down regulated features (negative z-scores).
An edge represents interaction among two adjacent time point. For example, it can represent features that are up-regulated
in week 1 in both males and females, and null in both male and females by week 2.
<code>min_analyte_posterior_thr</code> is used to make sure that features without any reasonable fit in the clustering solution will be discarded,
whereas <code>min_prior_for_config</code> removes clusters with extremely low prior (i.e., do not have any associated features).</p>
<p>Formally, let zscores be the timewise nxm matrix of z-scores over n analytes and m conditions, where m is even
and has the same time points for males and females.
Each z-score corresponds to the effect of training compared to untrained baseline.
We assume that z-scores have a latent configuration in -1,0,1, with -1 denotes down-regulation,
0 denotes null (no change), and 1 denotes up-regulation.
Let h denote the latent configuration of an analyte over all m conditions.
We use the expectation-maximization (EM) process of the repfdr algorithm (Heller and Yekutieli, 2014)
to estimate the prior π(h) and posterior Pr(h|z_i), for every analyte i.
Once the algorithm converges, we discard configurations h with π(h) &lt; min_analyte_posterior_thr and normalize Pr(h|zi)
to sum to 1 (i.e., all posteriors given the same zi). The new posteriors that can be interpreted as a soft clustering solution,
where the greater the value is, the more likely it is for analyte i to participate in cluster h.</p>
<p>Given the posteriors Pr(h|zi), we assign analytes to nine possible states in each time point (male or females x time points 1w, 2w,4w, and 8w).
Analyte i belongs to a state if the sum of posteriors that are consistent with that state is &gt; min_analyte_posterior_thr.
For every pair of states from adjacent time points j and j+1 we define their edge set as the set of analytes whose
differential expression pattern is consistent with the two nodes..
Thus, the node and edge sets explained above together define a tree structure that represent different differential patterns over sex and time.</p>
<p>Naming format for the output:
Node set names: <code>{week}_F{differential regulation status}_M{differential regulation status}</code>.
Example 1: <code>1w_F1_M0</code> means up-regulation in females week 1 and null (zero effect) in males in week 1.
Example 2: <code>1w_F1_M-1</code> means up-regulation in females week 1 and down-regulation in males in week 1.
The edge set object is a named list of string vectors. The name of an edge is <code>[node_id]---[node_id]</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co">### Example 1: Simulate data with a single cluster</span></span></span>
<span class="r-in"><span><span class="va">zcolnames</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"female"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1w"</span>,<span class="st">"2w"</span>,<span class="st">"4w"</span>,<span class="st">"8w"</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"male"</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1w"</span>,<span class="st">"2w"</span>,<span class="st">"4w"</span>,<span class="st">"8w"</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">"_"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zscores</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fl">80000</span><span class="op">)</span>, ncol<span class="op">=</span><span class="fl">8</span>, dimnames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10000</span>,<span class="va">zcolnames</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># now add a cluster with a strong signal </span></span></span>
<span class="r-in"><span><span class="va">zscores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">=</span> <span class="va">zscores</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span> <span class="op">+</span> <span class="fl">5</span> </span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Run the clustering solution wrapper.</span></span></span>
<span class="r-in"><span><span class="co"># When the data are "clean" (e.g., a mixture of two gaussians), we do not</span></span></span>
<span class="r-in"><span><span class="co"># need a high df in the two-groups model estimation</span></span></span>
<span class="r-in"><span><span class="co"># (default is 20, consider at least 10 when analyzing real data)</span></span></span>
<span class="r-in"><span><span class="va">clustering_sol</span> <span class="op">=</span> <span class="fu">bayesian_graphical_clustering</span><span class="op">(</span><span class="va">zscores</span>, df<span class="op">=</span><span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  2   female_2w ,f(z) misfit =  1.9 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column 7 male_4w the estimated fraction of nulls is 1.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column 8 male_8w the estimated fraction of nulls is 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged after 1 EM iterations.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  1   female_1w ,f(z) misfit =  5.8 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  2   female_2w ,f(z) misfit =  7.2 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  3   female_4w ,f(z) misfit =  5.5 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  4   female_8w ,f(z) misfit =  6.8 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column 7 male_4w the estimated fraction of nulls is 1.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column 8 male_8w the estimated fraction of nulls is 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged after 1 EM iterations.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  1   female_1w ,f(z) misfit =  15 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  2   female_2w ,f(z) misfit =  7.6 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  3   female_4w ,f(z) misfit =  14.4 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column  4   female_8w ,f(z) misfit =  9 . Rerun with increased df</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column 5 male_1w the estimated fraction of nulls is 1.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column 6 male_2w the estimated fraction of nulls is 1.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column 7 male_4w the estimated fraction of nulls is 1.</span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>In column 8 male_8w the estimated fraction of nulls is 1.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 7</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 8</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 11</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 12</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 13</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 14</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 15</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 16</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 17</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 18</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 19</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 20</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 21</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 22</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 23</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 24</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 25</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 27</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 28</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 29</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 30</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 31</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 32</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 33</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 34</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 35</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 36</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 37</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 38</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 39</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 40</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 41</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 42</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 43</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 44</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 45</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 46</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 47</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 48</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 49</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 50</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 51</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 52</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 53</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 54</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 55</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 56</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 57</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 58</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 59</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 60</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 61</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 62</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 63</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 64</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 65</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 66</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 67</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 68</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 69</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 70</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 71</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 72</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 73</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 74</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 75</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 76</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 77</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 78</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 79</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 80</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 81</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 82</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 83</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 84</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 85</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 86</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 87</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 88</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 89</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 90</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 91</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 92</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 93</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 94</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 95</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 96</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 97</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> EM iteration 98</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Converged after 97 EM iterations.</span>
<span class="r-in"><span><span class="co"># check if the clustering solution correctly assigns the first 500 rows </span></span></span>
<span class="r-in"><span><span class="co"># (with high prob) to the right nodes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="va">clustering_sol</span><span class="op">$</span><span class="va">node_sets</span><span class="op">$</span><span class="va">`1w_F1_M0`</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">500</span> <span class="op">&gt;</span> <span class="fl">0.95</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="va">clustering_sol</span><span class="op">$</span><span class="va">node_sets</span><span class="op">$</span><span class="va">`2w_F1_M0`</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">500</span> <span class="op">&gt;</span> <span class="fl">0.95</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="va">clustering_sol</span><span class="op">$</span><span class="va">node_sets</span><span class="op">$</span><span class="va">`4w_F1_M0`</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">500</span> <span class="op">&gt;</span> <span class="fl">0.95</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sets.html" class="external-link">intersect</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">500</span>,<span class="va">clustering_sol</span><span class="op">$</span><span class="va">node_sets</span><span class="op">$</span><span class="va">`8w_F1_M0`</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fl">500</span> <span class="op">&gt;</span> <span class="fl">0.95</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] TRUE</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># examine the node set sizes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">clustering_sol</span><span class="op">$</span><span class="va">node_sets</span>,<span class="va">length</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1w_F0_M0  1w_F1_M0  2w_F0_M0  2w_F1_M0  4w_F0_M0  4w_F1_M0 8w_F-1_M0  8w_F0_M0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      9493       505      9493       505      9493       505         2      9491 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  8w_F1_M0        0w </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       505     10000 </span>
<span class="r-in"><span><span class="co"># examine the edge set sizes</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>,<span class="va">length</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>        0w---1w_F0_M0        0w---1w_F1_M0  1w_F0_M0---2w_F0_M0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 9493                  505                 9493 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  1w_F1_M0---2w_F0_M0  1w_F0_M0---2w_F1_M0  1w_F1_M0---2w_F1_M0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                    0                    0                  505 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2w_F0_M0---4w_F0_M0  2w_F1_M0---4w_F0_M0  2w_F0_M0---4w_F1_M0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 9493                    0                    0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  2w_F1_M0---4w_F1_M0 4w_F0_M0---8w_F-1_M0 4w_F1_M0---8w_F-1_M0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  505                    2                    0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4w_F0_M0---8w_F0_M0  4w_F1_M0---8w_F0_M0  4w_F0_M0---8w_F1_M0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                 9491                    0                    0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  4w_F1_M0---8w_F1_M0 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                  505 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract the top full trajectories in the data</span></span></span>
<span class="r-in"><span><span class="co"># these should be the clusters with at least 10 features</span></span></span>
<span class="r-in"><span><span class="va">min_cluster_size</span> <span class="op">=</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_trajectory_sizes_from_edge_sets.html">get_trajectory_sizes_from_edge_sets</a></span><span class="op">(</span><span class="va">clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>,min_size <span class="op">=</span> <span class="va">min_cluster_size</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   X1       X2       X3       X4       X5   X6</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0w 1w_F0_M0 2w_F0_M0 4w_F0_M0 8w_F0_M0 9491</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0w 1w_F1_M0 2w_F1_M0 4w_F1_M0 8w_F1_M0  505</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">### Example 2: real data</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">REPFDR_INPUTS</span>, package<span class="op">=</span><span class="st">"MotrpacRatTraining6moData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">zscores</span> <span class="op">=</span> <span class="va">REPFDR_INPUTS</span><span class="op">$</span><span class="va">zs_smoothed</span></span></span>
<span class="r-in"><span><span class="va">rat_data_clustering_sol</span> <span class="op">=</span> <span class="fu">bayesian_graphical_clustering</span><span class="op">(</span><span class="va">zscores</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># extract the largest trajectories</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_trajectory_sizes_from_edge_sets.html">get_trajectory_sizes_from_edge_sets</a></span><span class="op">(</span><span class="va">rat_data_clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>, min_size <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># plot the top trajectories of the muscle tissues, color edges by tissue</span></span></span>
<span class="r-in"><span><span class="fu"><a href="get_tree_plot_for_tissue.html">get_tree_plot_for_tissue</a></span><span class="op">(</span>tissues <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"SKM-GN"</span>,<span class="st">"HEART"</span>,<span class="st">"SKM-VL"</span><span class="op">)</span>, </span></span>
<span class="r-in"><span>                         omes <span class="op">=</span> <span class="st">"TRNSCRPT"</span>,</span></span>
<span class="r-in"><span>                         node_sets <span class="op">=</span> <span class="va">rat_data_clustering_sol</span><span class="op">$</span><span class="va">node_sets</span>,</span></span>
<span class="r-in"><span>                         edge_sets <span class="op">=</span> <span class="va">rat_data_clustering_sol</span><span class="op">$</span><span class="va">edge_sets</span>,</span></span>
<span class="r-in"><span>                         min_size <span class="op">=</span> <span class="fl">20</span>,</span></span>
<span class="r-in"><span>                         parallel_edges_by_tissue <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>                         max_trajectories <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Nicole Gay, David Amar, Pierre Jean Beltran, MoTrPAC Study Group, NIH Common Fund, National Institute of Diabetes and Digestive and Kidney Diseases (NIDDK), National Institute of Arthritis and Musculoskeletal Diseases (NIAMS), National Institute on Aging (NIA), National Institute of Biomedical Imaging and Bioengineering.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

    </footer></div>

  

  

  </body></html>

